{"version":3,"sources":["../../bower_components/closestColor/closestColor.js","../../src/js/methods/ajaxCall.js","../../src/js/app.js","../../src/js/plugins/modernizr-custom.js","../../src/js/plugins/safeConsole.js","../../src/js/utils/addClass.js","../../src/js/utils/checkBrowser.js","../../src/js/utils/cloneObj.js","../../src/js/utils/createCSSClass.js","../../src/js/utils/detectFullscreen.js","../../src/js/utils/editCSSRule.js","../../src/js/utils/getAverageRGB.js","../../src/js/utils/getBrowserPrefix.js","../../src/js/utils/hasClass.js","../../src/js/utils/listenTo.js","../../src/js/utils/removeClass.js","../../src/js/utils/roundTo.js","../../src/js/utils/stopListeningTo.js","../../src/js/utils/trim.js","../../src/js/config.js","../../src/js/config/easings.js","../../src/js/config/keyCodes.js","../../src/js/config/labels.js","../../src/js/config/toolbarButtons.js","../../src/js/methods/animate.js","../../src/js/methods/canMove.js","../../src/js/methods/canPush.js","../../src/js/methods/changeBg.js","../../src/js/methods/checkFeatures.js","../../src/js/methods/countMove.js","../../src/js/methods/createBoard.js","../../src/js/methods/deselectTile.js","../../src/js/methods/dragTile.js","../../src/js/methods/getMovableTiles.js","../../src/js/methods/getTile.js","../../src/js/methods/init.js","../../src/js/methods/initListeners.js","../../src/js/methods/isTile.js","../../src/js/methods/loadGame.js","../../src/js/methods/metricsUpdate.js","../../src/js/methods/moveAnyTile.js","../../src/js/methods/moveTile.js","../../src/js/methods/newGame.js","../../src/js/methods/optimizeRedraws.js","../../src/js/methods/refresh.js","../../src/js/methods/reqAnimFrame.js","../../src/js/methods/saveGame.js","../../src/js/methods/selectTile.js","../../src/js/methods/setBg.js","../../src/js/methods/shuffle.js","../../src/js/methods/start.js","../../src/js/methods/stop.js","../../src/js/methods/vibrate.js"],"names":["getClosestColor","inputColor","palette","isValidColor","color","test","normalizedColor","length","toUpperCase","isValidPalette","Array","i","normalizedPalette","hex2dec","hex","parseInt","getComponents","rgbToXyz","r","g","b","_r","_g","_b","Math","pow","xyzToLab","x","y","z","ref_X","ref_Y","ref_Z","_X","_Y","_Z","rgbToLab","xyz","substr","rgb","lab","colorDifference","color1","color2","lab1","lab2","sqrt","closestColor","jsonpCall","url","callback","callbackName","round","random","window","data","document","body","removeChild","jsonpCallScript","createElement","src","indexOf","appendChild","game","utils","config","metrics","Modernizr","e","t","n","C","f","cssText","L","A","O","M","s","bind","_","charAt","slice","d","join","split","v","E","N","o","documentElement","u","a","style","h","p","toLowerCase","m","w","S","l","c","id","innerHTML","background","overflow","parentNode","matchMedia","msMatchMedia","matches","getComputedStyle","currentStyle","T","hasOwnProperty","call","constructor","prototype","Function","this","TypeError","arguments","apply","concat","Object","touch","DocumentTouch","offsetTop","cssanimations","csstransforms3d","offsetLeft","offsetHeight","csstransitions","localstorage","localStorage","setItem","removeItem","D","push","addTest","className","_version","_prefixes","_domPrefixes","_cssomPrefixes","mq","testProp","testAllProps","testStyles","replace","method","noop","methods","console","addClass","element","cls","checkBrowser","navigator","userAgent","parseFloat","appVersion","cloneObj","obj","copy","attr","createCSSClass","selector","styleSheets","getElementsByTagName","styleSheet","mediaType","media","disabled","mediaText","styleSheetElement","type","rules","selectorText","addRule","cssRules","insertRule","detectFullscreen","standalone","editCSSRule","ruleClass","property","newValue","sheet","getAverageRGB","img","imageData","canvas","ctx","getContext","width","naturalWidth","height","naturalHeight","defaultRGB","drawImage","getImageData","log","floor","getBrowserPrefix","styles","pre","match","OLink","dom","RegExp","lowercase","css","js","hasClass","listenTo","eventType","fn","listenersList","context","addEventListener","event","preventDefault","touches","timeStamp","multiTouchEvent","attachEvent","removeClass","regexp","roundTo","input","num","resto","stopListeningTo","removeEventListener","undefined","trim","str","ws","size","margin","borderSize","pushMultiple","minDistanceToMoveTile","clickToMove","maxTimeForClickMove","touchTolerance","transitionDuration","generic","byKeyboard","useKeyboard","easings","EASING_TILES_MOVEMENT","keycodes","KEY_ARROW_LEFT","KEY_ARROW_UP","KEY_ARROW_RIGHT","KEY_ARROW_DOWN","KEY_ESCAPE","KEY_RETURN","labels","WRAPPER_ID","GAME_ID","BOARD_ID","TOOLBAR_ID","BACKGROUND_CONTAINER_ID","BACKGROUND_IMAGE_ID","TILE_PREFIX","TILE_CLASS","TILE_INNER_CLASS","TILE_NUMBER_CLASS","TBUTTON_PREFIX","SELECTED_LABEL","PRESSED_LABEL","ANIMATED_LABEL","USETOUCH_LABEL","NO_TOUCH_LABEL","UP","RIGHT","DOWN","LEFT","LANDSCAPE","PORTRAIT","SAVEDGAMES_LABEL","AUTOSAVE_LABEL","USERSAVE_LABEL","SORTEDSAVE_LABEL","SHUFFLEDSAVE_LABEL","toolbarButtons","description","handler","confirm","newGame","saveGame","getElementById","loadGame","animate","animation","duration","ajaxCall","xmlhttp","XMLHttpRequest","onreadystatechange","status","readyState","responseText","open","send","params","CSSstyleDeclaration","prefix","browserPrefixes","iterations","iteration","delay","easing","runtime","eventListeners","target","canMove","tile","isTile","hole","tiles","HOLE_INDEX","holePosition","col","row","canPush","tilesToPush","pushableTiles","abs","direction","changeBg","setBgImage","imgUrl","checkFeatures","browserOK","alert","useTouch","useCSStransitions","use3Dtransforms","useLstorage","useVibration","useCssAnimations","launchedAsApp","useReqAnimFrame","requestAnimationFrame","countMove","movesCount","createBoard","boardHTML","setAttribute","correctCol","correctRow","even","evenCol","evenRow","htmlElement","deselectTile","selectedTile","tilesMoved","dragging","vibrate","newPosition","left","pixels","revert","moveTile","transitions","force","refresh","oldPosition","tileWidth","top","tileHeight","dragTile","running","newPosX","newPosY","otherTile","otherTileNewPos","offset","pageX","pageY","min","max","percent","transforms3Dsupport","addMovingTile","renderMovingTiles","getMovableTiles","pushing","moving","movableTiles","getTile","param","maxLevels","srcElement","isNaN","elementFromPoint","init","started","ended","timePlaying","resizeTimer","latestSelection","metricsUpdate","initListeners","start","selectTile","from","relatedTarget","toElement","nodeName","which","moveAnyTile","ctrlKey","Event","dispatchEvent","optimizeRedraws","clearTimeout","setTimeout","tileID","loadedGames","JSON","parse","getItem","loadedGame","saveDate","Date","UTC","startedDate","wrapperHTML","gameHTML","wrapperWidth","offsetWidth","wrapperHeight","cssPrefix","wrapperOrientation","wrapperRatio","pixelRatio","devicePixelRatio","wrapperSize","boardLayout","boardRatio","fontSize","marginH","marginV","backgroundImage","averageRGB_brighter","tileWpc","tileHpc","bgSize","sort","t1","t2","temp","redraw","animationDuration","stop","shuffle","state","elements","visibility","win","movingTiles","childNodes","backgroundPosition","offse","tileObj","cssString","tileId","savedGames","savedGame","toUTCString","stringify","crossOrigin","applyBgImage","tileName","averageRGB","applyBgColor","adjustColor","mode","amount","limit","rgbVal","hexVal","toString","rgbDark","rgbDarkVal","hexDarkVal","rgbBright","rgbBrightVal","hexBrightVal","averageRGB_darker","averageHEX","averageHEX_darker","averageHEX_brighter","blackish","whiteish","backgroundColor","currentBoxShadow","boxShadowProps","directions","reasonToVibrate"],"mappings":"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","file":"app.min.js","sourcesContent":["\n// \n// getClosestColor is a simple, dependancy free function that,\n// given any color hex code and a palette (in the form of \n// an array of colors hex codes) will return the hex code of \n// the most visually similar color in the palette\n// \n// Usage: getClosestColor(color, palette);\n// \n\n\n\nfunction getClosestColor(inputColor, palette) {\n\n    \"use strict\";\n\n    //\n    // input normalizaion\n    //\n\n    palette = normalizedPalette(palette);\n    inputColor = normalizedColor(inputColor);\n\n    if (!inputColor) {\n        throw \"error: invalid input color\";\n    }\n\n    if (!palette) {\n        throw \"error: invalid input palette\";\n    }\n\n    function isValidColor(color) {\n\n        if (typeof color !== \"string\") {\n            return false;\n        }\n\n        if (!/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/.test(color)) {\n            return false;\n        }\n\n        return true;\n    }\n\n    function normalizedColor(color) {\n\n        if (isValidColor(color) && color.length !== 7) {\n            // convert short color format to full length color format \n            color = color[0] + color[1] + color[1] + color[2] + color[2] + color[3] + color[3];\n        }\n\n        return color.toUpperCase();\n    }\n\n    function isValidPalette(palette) {\n\n        if ( !(typeof palette === \"object\") || !(palette instanceof Array)) {\n            return false;\n        }\n\n        if (palette.length === 0) {\n            return false;\n        }\n\n        for (var i = 0; i < palette.length; i++) {\n\n            if (!isValidColor(palette[i])) {\n                return false;\n            } \n\n            palette[i] = normalizedColor(palette[i]);\n            \n        }\n\n        return true;\n    }\n\n    function normalizedPalette(palette) {\n\n        if (isValidPalette(palette)) {\n            for (var i = 0; i < palette.length; i++) {\n                palette[i] = normalizedColor(palette[i]);\n            }\n        }\n\n        return palette;\n    }\n\n    function hex2dec(hex) {\n        return parseInt(hex, 16);\n    }\n\n    function getComponents(color) {\n\n        var r = hex2dec(color.substr(1, 2));\n        var g = hex2dec(color.substr(3, 2));\n        var b = hex2dec(color.substr(5, 2));\n\n        function rgbToXyz(r, g, b) {\n\n            // from https://software.intel.com/en-us/html5/hub/blogs/exploring-color-matching-in-javascript\n\n            var _r = (r / 255);\n            var _g = (g / 255);\n            var _b = (b / 255);\n\n            if (_r > 0.04045) {\n                _r = Math.pow(((_r + 0.055) / 1.055), 2.4);\n            } else {\n                _r = _r / 12.92;\n            }\n\n            if (_g > 0.04045) {\n                _g = Math.pow(((_g + 0.055) / 1.055), 2.4);\n            } else {\n                _g = _g / 12.92;\n            }\n\n            if (_b > 0.04045) {\n                _b = Math.pow(((_b + 0.055) / 1.055), 2.4);\n            } else {\n                _b = _b / 12.92;\n            }\n\n            _r = _r * 100;\n            _g = _g * 100;\n            _b = _b * 100;\n\n            var X = _r * 0.4124 + _g * 0.3576 + _b * 0.1805;\n            var Y = _r * 0.2126 + _g * 0.7152 + _b * 0.0722;\n            var Z = _r * 0.0193 + _g * 0.1192 + _b * 0.9505;\n\n            return [X, Y, Z];\n        }\n\n        function xyzToLab(x, y, z) {\n\n            // from https://software.intel.com/en-us/html5/hub/blogs/exploring-color-matching-in-javascript\n\n            var ref_X = 95.047;\n            var ref_Y = 100.000;\n            var ref_Z = 108.883;\n\n            var _X = x / ref_X;\n            var _Y = y / ref_Y;\n            var _Z = z / ref_Z;\n\n            if (_X > 0.008856) {\n                _X = Math.pow(_X, (1 / 3));\n            } else {\n                _X = (7.787 * _X) + (16 / 116);\n            }\n\n            if (_Y > 0.008856) {\n                _Y = Math.pow(_Y, (1 / 3));\n            } else {\n                _Y = (7.787 * _Y) + (16 / 116);\n            }\n\n            if (_Z > 0.008856) {\n                _Z = Math.pow(_Z, (1 / 3));\n            } else {\n                _Z = (7.787 * _Z) + (16 / 116);\n            }\n\n            var CIE_L = (116 * _Y) - 16;\n            var CIE_a = 500 * (_X - _Y);\n            var CIE_b = 200 * (_Y - _Z);\n\n            return [CIE_L, CIE_a, CIE_b];\n        }\n\n        function rgbToLab(r, g, b) {\n\n            var xyz = rgbToXyz(r, g, b);\n            var lab = xyzToLab(xyz[0], xyz[1], xyz[2]);\n\n            return lab;\n        }\n\n        return {\n            hex: color,\n            rgb: [r, g, b],\n            lab: rgbToLab(r, g, b)\n        };\n    }\n\n    function colorDifference(color1, color2) {\n\n        var lab1 = getComponents(color1).lab;\n        var lab2 = getComponents(color2).lab;\n\n        var deltaE = Math.sqrt(\n            Math.pow(lab2[0] - lab1[0], 2) +\n            Math.pow(lab2[1] - lab1[1], 2) +\n            Math.pow(lab2[2] - lab1[2], 2)\n        );\n\n        return deltaE;\n    }   \n\n\n    // \n    // loop the palette to choose the closest color \n    // \n\n    var closestColor = palette[0];\n\n    for (var i = 0; i < palette.length; i++) {\n\n        if (colorDifference(inputColor, palette[i]) < colorDifference(inputColor, closestColor)) {\n            closestColor = palette[i];\n        }\n\n    }\n\n    return closestColor; \n\n}\n","game.ajaxCall = function(url) {\r\n  \"use strict\";\r\n\r\n  var xmlhttp;\r\n  if (window.XMLHttpRequest) {\r\n    xmlhttp = new XMLHttpRequest();\r\n  } else {\r\n    return false;\r\n  }\r\n\r\n  xmlhttp.onreadystatechange = function() {\r\n\r\n    console.log(xmlhttp.status);\r\n\r\n    if (xmlhttp.readyState === 4 && xmlhttp.status === 200) {\r\n      console.log(xmlhttp.responseText);\r\n    }\r\n\r\n  };\r\n\r\n  xmlhttp.open(\"GET\", url, true);\r\n  xmlhttp.send();\r\n\r\n\r\n};\r\n\r\n\r\nfunction jsonpCall(url, callback) {\r\n\r\n  \"use strict\";\r\n\r\n  var callbackName = \"jsonp_callback_\" + Math.round(100000 * Math.random());\r\n\r\n  window[callbackName] = function(data) {\r\n    delete window[callbackName];\r\n    document.body.removeChild(jsonpCallScript);\r\n    callback(data);\r\n  };\r\n\r\n  var jsonpCallScript = document.createElement(\"script\");\r\n  jsonpCallScript.src = url + (url.indexOf(\"?\") >= 0 ? \"&\" : \"?\") + \"callback=\" + callbackName;\r\n  document.body.appendChild(jsonpCallScript);\r\n}\r\n","var game = {\r\n  utils: {},\r\n  config: {},\r\n  metrics: {}\r\n};\r\n","/* Modernizr (Custom Build) | MIT & BSD\n * Build: http://modernizr.com/download/#-mq-cssclasses-csstransforms3d-cssanimations-csstransitions-touch-localstorage\n */\n;\nwindow.Modernizr = function(e, t, n) {\n  function C(e) {\n    f.cssText = e\n  }\n\n  function k(e, t) {\n    return C(h.join(e + \";\") + (t || \"\"))\n  }\n\n  function L(e, t) {\n    return typeof e === t\n  }\n\n  function A(e, t) {\n    return !!~(\"\" + e).indexOf(t)\n  }\n\n  function O(e, t) {\n    for (var r in e) {\n      var i = e[r];\n      if (!A(i, \"-\") && f[i] !== n) return t == \"pfx\" ? i : !0\n    }\n    return !1\n  }\n\n  function M(e, t, r) {\n    for (var i in e) {\n      var s = t[e[i]];\n      if (s !== n) return r === !1 ? e[i] : L(s, \"function\") ? s.bind(r || t) : s\n    }\n    return !1\n  }\n\n  function _(e, t, n) {\n    var r = e.charAt(0).toUpperCase() + e.slice(1),\n      i = (e + \" \" + d.join(r + \" \") + r).split(\" \");\n    return L(t, \"string\") || L(t, \"undefined\") ? O(i, t) : (i = (e + \" \" + v.join(r + \" \") + r).split(\" \"), M(i, t, n))\n  }\n  var r = \"2.8.3\",\n    i = {},\n    s = !0,\n    o = t.documentElement,\n    u = \"modernizr\",\n    a = t.createElement(u),\n    f = a.style,\n    l, c = {}.toString,\n    h = \" -webkit- -moz- -o- -ms- \".split(\" \"),\n    p = \"Webkit Moz O ms\",\n    d = p.split(\" \"),\n    v = p.toLowerCase().split(\" \"),\n    m = {},\n    g = {},\n    y = {},\n    b = [],\n    w = b.slice,\n    E, S = function(e, n, r, i) {\n      var s, a, f, l, c = t.createElement(\"div\"),\n        h = t.body,\n        p = h || t.createElement(\"body\");\n      if (parseInt(r, 10))\n        while (r--) f = t.createElement(\"div\"), f.id = i ? i[r] : u + (r + 1), c.appendChild(f);\n      return s = [\"&#173;\", '<style id=\"s', u, '\">', e, \"</style>\"].join(\"\"), c.id = u, (h ? c : p).innerHTML += s, p.appendChild(c), h || (p.style.background = \"\", p.style.overflow = \"hidden\", l = o.style.overflow, o.style.overflow = \"hidden\", o.appendChild(p)), a = n(c, e), h ? c.parentNode.removeChild(c) : (p.parentNode.removeChild(p), o.style.overflow = l), !!a\n    },\n    x = function(t) {\n      var n = e.matchMedia || e.msMatchMedia;\n      if (n) return n(t) && n(t).matches || !1;\n      var r;\n      return S(\"@media \" + t + \" { #\" + u + \" { position: absolute; } }\", function(t) {\n        r = (e.getComputedStyle ? getComputedStyle(t, null) : t.currentStyle)[\"position\"] == \"absolute\"\n      }), r\n    },\n    T = {}.hasOwnProperty,\n    N;\n  !L(T, \"undefined\") && !L(T.call, \"undefined\") ? N = function(e, t) {\n    return T.call(e, t)\n  } : N = function(e, t) {\n    return t in e && L(e.constructor.prototype[t], \"undefined\")\n  }, Function.prototype.bind || (Function.prototype.bind = function(t) {\n    var n = this;\n    if (typeof n != \"function\") throw new TypeError;\n    var r = w.call(arguments, 1),\n      i = function() {\n        if (this instanceof i) {\n          var e = function() {};\n          e.prototype = n.prototype;\n          var s = new e,\n            o = n.apply(s, r.concat(w.call(arguments)));\n          return Object(o) === o ? o : s\n        }\n        return n.apply(t, r.concat(w.call(arguments)))\n      };\n    return i\n  }), m.touch = function() {\n    var n;\n    return \"ontouchstart\" in e || e.DocumentTouch && t instanceof DocumentTouch ? n = !0 : S([\"@media (\", h.join(\"touch-enabled),(\"), u, \")\", \"{#modernizr{top:9px;position:absolute}}\"].join(\"\"), function(e) {\n      n = e.offsetTop === 9\n    }), n\n  }, m.cssanimations = function() {\n    return _(\"animationName\")\n  }, m.csstransforms3d = function() {\n    var e = !!_(\"perspective\");\n    return e && \"webkitPerspective\" in o.style && S(\"@media (transform-3d),(-webkit-transform-3d){#modernizr{left:9px;position:absolute;height:3px;}}\", function(t, n) {\n      e = t.offsetLeft === 9 && t.offsetHeight === 3\n    }), e\n  }, m.csstransitions = function() {\n    return _(\"transition\")\n  }, m.localstorage = function() {\n    try {\n      return localStorage.setItem(u, u), localStorage.removeItem(u), !0\n    } catch (e) {\n      return !1\n    }\n  };\n  for (var D in m) N(m, D) && (E = D.toLowerCase(), i[E] = m[D](), b.push((i[E] ? \"\" : \"no-\") + E));\n  return i.addTest = function(e, t) {\n    if (typeof e == \"object\")\n      for (var r in e) N(e, r) && i.addTest(r, e[r]);\n    else {\n      e = e.toLowerCase();\n      if (i[e] !== n) return i;\n      t = typeof t == \"function\" ? t() : t, typeof s != \"undefined\" && s && (o.className += \" \" + (t ? \"\" : \"no-\") + e), i[e] = t\n    }\n    return i\n  }, C(\"\"), a = l = null, i._version = r, i._prefixes = h, i._domPrefixes = v, i._cssomPrefixes = d, i.mq = x, i.testProp = function(e) {\n    return O([e])\n  }, i.testAllProps = _, i.testStyles = S, o.className = o.className.replace(/(^|\\s)no-js(\\s|$)/, \"$1$2\") + (s ? ' js ' + b.join(' ') : \"\"), i\n}(this, this.document);\n","// Avoid `console` errors in browsers that lack a console.\r\n// credits https://github.com/h5bp/html5-boilerplate/blob/master/dist/js/plugins.js\r\n(function() {\r\n  \"use strict\";\r\n  var method;\r\n  var noop = function() {};\r\n  var methods = [\r\n    'assert', 'clear', 'count', 'debug', 'dir', 'dirxml', 'error',\r\n    'exception', 'group', 'groupCollapsed', 'groupEnd', 'info', 'log',\r\n    'markTimeline', 'profile', 'profileEnd', 'table', 'time', 'timeEnd',\r\n    'timeStamp', 'trace', 'warn'\r\n  ];\r\n  var length = methods.length;\r\n  var console = (window.console = window.console || {});\r\n\r\n  while (length--) {\r\n    method = methods[length];\r\n\r\n    // Only stub undefined methods.\r\n    if (!console[method]) {\r\n      console[method] = noop;\r\n    }\r\n  }\r\n}());\r\n","game.utils.addClass = function(element, cls) {\r\n  \"use strict\";\r\n  if ((\" \" + element.className + \" \").indexOf(\" \" + cls + \" \") === -1) {\r\n    element.className = element.className + \" \" + cls;\r\n  }\r\n  return element.className.replace(/  +/g, \" \");\r\n};\r\n","game.utils.checkBrowser = function() {\r\n  return !(/MSIE\\s/.test(navigator.userAgent) && parseFloat(navigator.appVersion.split(\"MSIE\")[1]) < 11);\r\n}\r\n","game.utils.cloneObj = function(obj) {\r\n  \"use strict\";\r\n  if (null === obj || \"object\" !== typeof obj) return obj;\r\n  var copy = obj.constructor();\r\n  for (var attr in obj) {\r\n    if (obj.hasOwnProperty(attr) && attr !== \"htmlElement\") copy[\r\n      attr] = obj[attr];\r\n  }\r\n  return copy;\r\n};\r\n","game.utils.createCSSClass = function(selector, style) {\r\n  \"use strict\";\r\n  if (!document.styleSheets) {\r\n    return false;\r\n  }\r\n\r\n  if (document.getElementsByTagName(\"head\").length === 0) {\r\n    return false;\r\n  }\r\n\r\n  var styleSheet;\r\n  var mediaType;\r\n  var media;\r\n  var i;\r\n\r\n  if (document.styleSheets.length > 0) {\r\n    for (i = 0; i < document.styleSheets.length; i++) {\r\n      if (document.styleSheets[i].disabled) {\r\n        continue;\r\n      }\r\n      media = document.styleSheets[i].media;\r\n      mediaType = typeof media;\r\n\r\n      if (mediaType === \"string\") {\r\n        if (media === \"\" || (media.indexOf(\"screen\") !== -1)) {\r\n          styleSheet = document.styleSheets[i];\r\n        }\r\n      } else if (mediaType === \"object\") {\r\n        if (media.mediaText === \"\" || (media.mediaText.indexOf(\"screen\") !== -1)) {\r\n          styleSheet = document.styleSheets[i];\r\n        }\r\n      }\r\n\r\n      if (typeof styleSheet !== \"undefined\") {\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  if (typeof styleSheet === \"undefined\") {\r\n    var styleSheetElement = document.createElement(\"style\");\r\n    styleSheetElement.type = \"text/css\";\r\n\r\n    document.getElementsByTagName(\"head\")[0].appendChild(styleSheetElement);\r\n\r\n    for (i = 0; i < document.styleSheets.length; i++) {\r\n      if (document.styleSheets[i].disabled) {\r\n        continue;\r\n      }\r\n      styleSheet = document.styleSheets[i];\r\n    }\r\n\r\n    media = styleSheet.media;\r\n    mediaType = typeof media;\r\n  }\r\n\r\n  if (mediaType === \"string\") {\r\n    for (i = 0; i < styleSheet.rules.length; i++) {\r\n      if (styleSheet.rules[i].selectorText.toLowerCase() === selector.toLowerCase()) {\r\n        styleSheet.rules[i].style.cssText = style;\r\n        return;\r\n      }\r\n    }\r\n\r\n    styleSheet.addRule(selector, style);\r\n  } else if (mediaType === \"object\") {\r\n    for (i = 0; i < styleSheet.cssRules.length; i++) {\r\n      if (styleSheet.cssRules[i].selectorText.toLowerCase() === selector.toLowerCase()) {\r\n        styleSheet.cssRules[i].style.cssText = style;\r\n        return;\r\n      }\r\n    }\r\n\r\n    styleSheet.insertRule(selector + \"{\" + style + \"}\", 0);\r\n  }\r\n};\r\n","game.utils.detectFullscreen = function() {\r\n  \"use strict\";\r\n  if ((\"standalone\" in window.navigator) && window.navigator.standalone) {\r\n    return true;\r\n  }\r\n  return false;\r\n};\r\n","game.utils.editCSSRule = function(ruleClass, property, newValue) {\r\n\r\n  \"use strict\";\r\n\r\n  for (var s = 0; s < document.styleSheets.length; s++) {\r\n    var sheet = document.styleSheets[s];\r\n    var rules = sheet.cssRules ? sheet.cssRules : sheet.rules;\r\n\r\n    if (rules == null) return \"null\";\r\n\r\n    for (var i = 0; i < rules.length; i++) {\r\n      if (rules[i].selectorText === ruleClass) {\r\n        if (typeof newValue !== \"undefined\") {\r\n          return rules[i].style[property] = newValue;\r\n        } else {\r\n          return rules[i].style[property];\r\n        };\r\n\r\n      }\r\n    }\r\n\r\n  }\r\n  return null;\r\n};\r\n","game.utils.getAverageRGB = function(img) {\r\n  \"use strict\";\r\n\r\n  var canvas = document.createElement('canvas');\r\n  var ctx = canvas.getContext('2d');\r\n  var width = canvas.width = img.naturalWidth;\r\n  var height = canvas.height = img.naturalHeight;\r\n  var imageData, data;\r\n  var defaultRGB = {\r\n    r: 200,\r\n    g: 200,\r\n    b: 200\r\n  };\r\n\r\n  ctx.drawImage(img, 0, 0);\r\n\r\n  try {\r\n    imageData = ctx.getImageData(0, 0, width, height);\r\n  } catch (e) {\r\n    console.log(\"Problem parsing this image\", e);\r\n    return defaultRGB;\r\n  }\r\n\r\n  data = imageData.data;\r\n\r\n  var r = 0;\r\n  var g = 0;\r\n  var b = 0;\r\n\r\n  for (var i = 0, l = data.length; i < l; i += 4) {\r\n    r += data[i];\r\n    g += data[i + 1];\r\n    b += data[i + 2];\r\n  }\r\n\r\n  r = Math.floor(r / (data.length / 4));\r\n  g = Math.floor(g / (data.length / 4));\r\n  b = Math.floor(b / (data.length / 4));\r\n\r\n  return {\r\n    r: r,\r\n    g: g,\r\n    b: b\r\n  };\r\n\r\n};\r\n","game.utils.getBrowserPrefix = function() {\r\n  \"use strict\";\r\n  var styles = window.getComputedStyle(document.documentElement, \"\"),\r\n    pre = (Array.prototype.slice\r\n      .call(styles)\r\n      .join(\"\")\r\n      .match(/-(moz|webkit|ms)-/) || (styles.OLink === \"\" && [\"\", \"o\"])\r\n    )[1],\r\n    dom = (\"WebKit|Moz|MS|O\").match(new RegExp(\"(\" + pre + \")\", \"i\"))[1];\r\n  return {\r\n    dom: [dom],\r\n    lowercase: [pre],\r\n    css: [\"-\" + pre + \"-\"],\r\n    js: [pre[0].toUpperCase() + pre.substr(1)]\r\n  };\r\n};\r\n","game.utils.hasClass = function(element, cls) {\r\n  \"use strict\";\r\n  return (\" \" + element.className + \" \").indexOf(\" \" + cls + \" \") > -1;\r\n};\r\n","game.utils.listenTo = function(element, eventType, fn, listenersList, context) {\r\n  \"use strict\";\r\n\r\n  listenersList = listenersList || {};\r\n\r\n  if (!element) {\r\n    console.log(\"can't find this element: \" + element);\r\n    return false;\r\n  }\r\n\r\n  var id = element.id;\r\n\r\n  if (typeof id === \"undefined\" || id === \"\") {\r\n\r\n    if (element === document.body) {\r\n      id = \"body\";\r\n    } else if (element === document.documentElement) {\r\n      id = \"html\";\r\n    } else if (element === window) {\r\n      id = \"window\";\r\n    } else {\r\n      console.log(\"better not add a listener to elements witout id: \",\r\n        element);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  if (typeof listenersList[id] === \"undefined\") {\r\n    listenersList[id] = {};\r\n  };\r\n\r\n  if (typeof listenersList[id][eventType] !== \"undefined\") {\r\n    console.log(\"cannot add another listener for \" + eventType + \" to \",\r\n      element);\r\n    return false;\r\n  };\r\n\r\n  listenersList[id][eventType] = fn;\r\n\r\n\r\n  if (!element.addEventListener) {\r\n    element.attachEvent(\"on\" + eventType, fn);\r\n  } else if (element.addEventListener) {\r\n\r\n    if (eventType.indexOf(\"touch\") === 0) {\r\n      element.addEventListener(eventType, function(event) {\r\n        event.preventDefault();\r\n        if (event.touches.length === 0) //touchend\r\n        {\r\n          fn(event, context);\r\n        } else {\r\n          for (var i = 0; i < event.touches.length; i++) {\r\n            event.touches[i].timeStamp = event.timeStamp;\r\n            event.touches[i].type = event.type;\r\n            event.touches[i].multiTouchEvent = event;\r\n            fn(event.touches[i], context);\r\n          }\r\n        }\r\n        return;\r\n      }, true);\r\n    } else {\r\n      element.addEventListener(eventType, function(event) {\r\n        fn(event, context);\r\n      }, false);\r\n    }\r\n  }\r\n};\r\n","game.utils.removeClass = function(element, cls) {\r\n  \"use strict\";\r\n\r\n  var regexp = new RegExp(\"\\\\b\" + cls + \"\\\\b\", \"g\");\r\n  element.className = \" \" + element.className + \" \";\r\n  element.className = element.className.replace(regexp, \"\");\r\n\r\n  return element.className.replace(/  +/g, \" \");\r\n};\r\n","game.utils.roundTo = function(input, num) {\r\n  \"use strict\";\r\n  var resto = input % num;\r\n  if (resto <= (num / 2)) {\r\n    return input - resto;\r\n  } else {\r\n    return input + num - resto;\r\n  }\r\n};\r\n","game.utils.stopListeningTo = function(element, eventType, listenersList) {\r\n  \"use strict\";\r\n\r\n  if (typeof listenersList === \"undefined\") {\r\n    console.log(\"no registered listeners in \", listenersList);\r\n    return false;\r\n  };\r\n\r\n  var id = element.id;\r\n\r\n  if (typeof element.id === \"undefined\" || element.id === \"\") {\r\n\r\n    if (element === document.body) {\r\n      id = \"body\";\r\n    } else if (element === document.documentElement) {\r\n      id = \"html\";\r\n    } else if (element === window) {\r\n      id = \"window\";\r\n    } else {\r\n      console.log(\"better not add a listener to elements witout id: \",\r\n        element);\r\n      return false;\r\n    }\r\n  };\r\n\r\n  if (typeof listenersList[id][eventType] !== \"undefined\") {\r\n    element.removeEventListener(eventType, listenersList[id][eventType]);\r\n    listenersList[id][eventType] = undefined;\r\n    // console.log(\"removed event listener for \" + eventType + \" from \" + id);\r\n    return true;\r\n  }\r\n\r\n\r\n  return false;\r\n\r\n};\r\n","game.utils.trim = function(str) {\r\n  \"use strict\";\r\n  str = str.replace(/^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g, \"\");\r\n  var ws = /\\s/;\r\n  var i = str.length;\r\n  while (ws.test(str.charAt(--i)));\r\n  return str.slice(0, i + 1);\r\n};\r\n","game.config = {\r\n\r\n  /*\r\n    size of the board, in tiles \r\n    (h for columns, v for rows)\r\n   */\r\n  size: {\r\n    h: 4,\r\n    v: 4\r\n  },\r\n\r\n  /*\r\n    minimum space btw the board and the screen, in %\r\n   */\r\n  margin: {\r\n    h: 4,\r\n    v: 4\r\n  },\r\n\r\n  /*\r\n    thickness of the border around the board, in %\r\n   */\r\n  borderSize: 4,\r\n\r\n  /*\r\n    when true tiles near the hole can be pushed by dragged tiles    \r\n   */\r\n  pushMultiple: true,\r\n\r\n\r\n  /*\r\n    move tolerance; the percent of a tile size after which \r\n    the tile snaps into the new position. If it's moved less than\r\n    this, the tile snaps back.\r\n   */\r\n  minDistanceToMoveTile: 0.25,\r\n\r\n\r\n  /* \r\n    allow move by click (touching and shortly releasing a tile \r\n    but not dragging it)\r\n  */\r\n\r\n  clickToMove: true,\r\n\r\n\r\n  /*\r\n    time in ms after which releasing a tile won't trigger a movement\r\n   */\r\n  maxTimeForClickMove: 200,\r\n\r\n\r\n  /*\r\n    touch tolerance area around the tile considered draggable \r\n    during touch drag before dropping\r\n   */\r\n  touchTolerance: 0.2,\r\n\r\n  /*\r\n    transitonDurations\r\n   */\r\n  transitionDuration: {\r\n\r\n    /* for tile movements on clicks, drags and gestures */\r\n    generic: 60,\r\n\r\n    /* for tile movement initiated by keyboard events*/\r\n    byKeyboard: 100\r\n  },\r\n\r\n  /*\r\n    listen to keyboard events during game\r\n   */\r\n  useKeyboard: true\r\n\r\n\r\n};\r\n","/*\r\n  a collection of easing functions\r\n */\r\ngame.config.easings = {\r\n  EASING_TILES_MOVEMENT: \"cubic-bezier(0.403, 0.543, 0.754, 1)\"\r\n};\r\n","/* keycodes abstractions */\r\ngame.config.keycodes = {\r\n  KEY_ARROW_LEFT: 37,\r\n  KEY_ARROW_UP: 38,\r\n  KEY_ARROW_RIGHT: 39,\r\n  KEY_ARROW_DOWN: 40,\r\n  KEY_ESCAPE: 2,\r\n  KEY_RETURN: 13\r\n};\r\n","/*\r\n  abstraction for IDs, CLASSES and so on\r\n */\r\ngame.config.labels = {\r\n\r\n  /* \r\n    id of the main wrapper of the page \r\n  */\r\n  WRAPPER_ID: \"game-wrapper\",\r\n\r\n  /* html id of the game container */\r\n  GAME_ID: \"game\",\r\n\r\n  /* id of the board*/\r\n  BOARD_ID: \"board\",\r\n\r\n  /* id of the toolbar */\r\n  TOOLBAR_ID: \"toolbar\",\r\n\r\n  /* id of the background image container */\r\n  BACKGROUND_CONTAINER_ID: \"bg\",\r\n\r\n  /* id of the background image element */\r\n  BACKGROUND_IMAGE_ID: \"bg-img\",\r\n\r\n  /* prefix for all tiles ids */\r\n  TILE_PREFIX: \"tile-\",\r\n\r\n  /* className for tile element */\r\n  TILE_CLASS: \"tile\",\r\n\r\n  /* className for tile inner wrapper */\r\n  TILE_INNER_CLASS: \"inner\",\r\n\r\n  /* className for tile number element*/\r\n  TILE_NUMBER_CLASS: \"number\",\r\n\r\n  /* prefix for all toolbar buttons ids */\r\n  TBUTTON_PREFIX: \"btn-\",\r\n\r\n  /* class added to a tile when is being dragged */\r\n  SELECTED_LABEL: \"selected\",\r\n\r\n  /* class added to a tile when is being pressed */\r\n  PRESSED_LABEL: \"pressed\",\r\n\r\n\r\n  /* class added to a tile when is being animated */\r\n  ANIMATED_LABEL: \"animationInProgress\",\r\n\r\n\r\n  /* class added to the game main div when touch enabled */\r\n  USETOUCH_LABEL: \"touch\",\r\n\r\n  /* class added to the game main div when touch disabled */\r\n  NO_TOUCH_LABEL: \"no-touch\",\r\n\r\n\r\n  /* Directions Abstraction */\r\n  UP: \"up\",\r\n  RIGHT: \"right\",\r\n  DOWN: \"down\",\r\n  LEFT: \"left\",\r\n\r\n  /* Orientations Abstraction */\r\n  LANDSCAPE: \"landscape\",\r\n  PORTRAIT: \"portrait\",\r\n\r\n  /* Saved games localStorage index */\r\n  SAVEDGAMES_LABEL: \"savedGames\",\r\n\r\n\r\n  /* Savegame modes */\r\n  AUTOSAVE_LABEL: \"automatic\",\r\n  USERSAVE_LABEL: \"user\",\r\n  SORTEDSAVE_LABEL: \"sorted\",\r\n  SHUFFLEDSAVE_LABEL: \"shuffled\"\r\n\r\n};\r\n","/* keycodes abstractions */\r\ngame.config.toolbarButtons = [{\r\n  id: \"new\",\r\n  description: \"New game\",\r\n  handler: function() {\r\n    if (window.confirm(\"Start a new game?\")) {\r\n      this.newGame();\r\n    };\r\n  }\r\n}, {\r\n  id: \"save\",\r\n  description: \"Save the board\",\r\n  handler: function() {\r\n    this.saveGame(this.config.labels.USERSAVE_LABEL);\r\n    this.utils.addClass(document.getElementById(\"btn-save\"), \"on\");\r\n  }\r\n}, {\r\n  id: \"load\",\r\n  description: \"Load the saved board\",\r\n  handler: function() {\r\n    if (window.confirm(\"Load the saved game?\")) {\r\n      this.loadGame(this.config.labels.USERSAVE_LABEL);\r\n    };\r\n    this.animate({\r\n      element: document.getElementById(this.config.labels.GAME_ID),\r\n      animation: \"load\",\r\n      duration: 1000\r\n    });\r\n  },\r\n}, {\r\n  id: \"settings\",\r\n  description: \"change your preferences\",\r\n  handler: function() {}\r\n}, {\r\n  id: \"info\",\r\n  description: \"About this game\",\r\n  handler: function() {}\r\n}];\r\n","game.animate = function(params) {\r\n  \"use strict\";\r\n\r\n  if (\r\n    typeof params === \"undefined\" ||\r\n    !params.element ||\r\n    typeof params.animation !== \"string\") {\r\n    console.log(\"wrong parameters in animate call\", params);\r\n    return false;\r\n  }\r\n  if (typeof params.duration !== \"number\") {\r\n    params.duration = this.config.transitionDuration.generic;\r\n  }\r\n\r\n\r\n  var CSSstyleDeclaration;\r\n  var prefix = \"\";\r\n\r\n  for (var p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n\r\n    prefix = this.config.browserPrefixes.css[p];\r\n\r\n    CSSstyleDeclaration += prefix + \"animation-fill-mode:both;\";\r\n    CSSstyleDeclaration += prefix + \"animation-duration:\" + params.duration + \"ms;\";\r\n    CSSstyleDeclaration += prefix + \"animation-name:\" + params.animation + \";\";\r\n\r\n    if (typeof params.iterations !== \"undefined\") {\r\n      CSSstyleDeclaration += prefix + \"animation-iteration-count:\" + params.iteration + \";\";\r\n    }\r\n\r\n    if (typeof params.delay === \"number\") {\r\n      CSSstyleDeclaration += prefix + \"animation-delay:\" + params.delay + \"ms;\";\r\n    }\r\n\r\n    if (typeof params.easing === \"string\") {\r\n      CSSstyleDeclaration += prefix + \"animation-timing-function:\" + params.easing + \";\";\r\n    }\r\n\r\n    if (p < 0) {\r\n      this.utils.listenTo(\r\n        params.element,\r\n        \"animationend\",\r\n        function(event, context) {\r\n\r\n          context.utils.stopListeningTo(\r\n            params.element,\r\n            \"animationend\",\r\n            context.runtime.eventListeners\r\n          );\r\n\r\n          event.target.style[\"animation-name\"] = \"\";\r\n        },\r\n        this.runtime.eventListeners,\r\n        this);\r\n    } else {\r\n\r\n      this.utils.listenTo(params.element, this.config.browserPrefixes.lowercase[p] + \"AnimationEnd\",\r\n        function(event, context) {\r\n\r\n          context.utils.stopListeningTo(\r\n            params.element,\r\n            event.type,\r\n            context.runtime.eventListeners\r\n          );\r\n\r\n          event.target.style[event.type.replace(\"End\", \"Name\")] = \"\";\r\n\r\n          context.utils.removeClass(params.element, context.config.labels.ANIMATED_LABEL);\r\n\r\n        },\r\n        this.runtime.eventListeners,\r\n        this\r\n      );\r\n\r\n    }\r\n  }\r\n  game.utils.addClass(params.element, game.config.labels.ANIMATED_LABEL);\r\n  params.element.style.cssText += CSSstyleDeclaration;\r\n};\r\n","game.canMove = function(tile) {\r\n  \"use strict\";\r\n  tile = this.isTile(tile) || null;\r\n\r\n  var hole = this.runtime.tiles[this.config.labels.TILE_PREFIX + this.config.labels\r\n      .HOLE_INDEX],\r\n    holePosition = hole.col + \"-\" + hole.row;\r\n\r\n  if (!tile) {\r\n    return false;\r\n  };\r\n\r\n  if (holePosition === (tile.col) + \"-\" + (tile.row - 1)) {\r\n    return this.config.labels.UP;\r\n  }\r\n  if (holePosition === (tile.col + 1) + \"-\" + (tile.row)) {\r\n    return this.config.labels.RIGHT;\r\n  }\r\n  if (holePosition === (tile.col) + \"-\" + (tile.row + 1)) {\r\n    return this.config.labels.DOWN;\r\n  }\r\n  if (holePosition === (tile.col - 1) + \"-\" + (tile.row)) {\r\n    return this.config.labels.LEFT;\r\n  }\r\n\r\n  return false;\r\n};\r\n","game.canPush = function(tile) {\r\n  \"use strict\";\r\n  tile = this.isTile(tile) || false;\r\n\r\n  var hole = this.runtime.tiles[this.config.labels.TILE_PREFIX + this.config.labels.HOLE_INDEX];\r\n  var tilesToPush = 0;\r\n  var pushableTiles = 0;\r\n\r\n  if (!tile) {\r\n    return false;\r\n  };\r\n\r\n  if (this.config.pushMultiple) {\r\n    if (tile.col === hole.col || tile.row === hole.row) {\r\n\r\n      tilesToPush = (tile.col - hole.col === 0) ? hole.row - tile.row : hole.col - tile.col;\r\n      pushableTiles = Math.abs(tilesToPush) - 1;\r\n\r\n\r\n      if (tilesToPush === 0 || pushableTiles === 0) {\r\n        return false;\r\n      }\r\n\r\n\r\n      if (tile.col === hole.col) // up or down\r\n      {\r\n        if (tilesToPush > 0) // down\r\n        {\r\n          return ({\r\n            n: pushableTiles,\r\n            direction: this.config.labels.DOWN\r\n          });\r\n        } else // up\r\n        {\r\n          return ({\r\n            n: pushableTiles,\r\n            direction: this.config.labels.UP\r\n          });\r\n        }\r\n      } else // left or right\r\n      {\r\n        if (tilesToPush > 0) // right\r\n        {\r\n          return ({\r\n            n: pushableTiles,\r\n            direction: this.config.labels.RIGHT\r\n          });\r\n        } else // left\r\n        {\r\n          return ({\r\n            n: pushableTiles,\r\n            direction: this.config.labels.LEFT\r\n          });\r\n        }\r\n      }\r\n    }\r\n\r\n  }\r\n\r\n  return false;\r\n};\r\n","game.changeBg = function(params) {\r\n  \"use strict\";\r\n\r\n  try {\r\n    this.setBgImage({\r\n      imgUrl: \"https://source.unsplash.com/random/\" + this.metrics.width + \"x\" + this.metrics.height\r\n    });\r\n  } catch (e) {\r\n    console.log(\"error loading a bg image\", e);\r\n  }\r\n\r\n}\r\n","game.checkFeatures = function() {\r\n  \"use strict\";\r\n\r\n\r\n  this.config.browserOK = game.utils.checkBrowser();\r\n\r\n  if (!this.config.browserOK) {\r\n    console.log(\"Browser not supported\");\r\n    alert(\"this browser version isn't supported\")\r\n    return false;\r\n  }\r\n\r\n  /*\r\n    if the device supports it listen for touch \r\n    events instead of mouse events      \r\n   */\r\n  this.config.useTouch = Modernizr.touch;\r\n\r\n  this.utils.addClass(document.getElementById(this.config.labels.GAME_ID),\r\n    this.config.useTouch ? this.config.labels.USETOUCH_LABEL : this.config.labels.NO_TOUCH_LABEL\r\n  );\r\n\r\n  /*\r\n    if the device supports it use 3D transforms \r\n    (which should be hardware accellerated) \r\n    instead of 2D transforms\r\n   */\r\n  this.config.useCSStransitions = Modernizr.csstransitions;\r\n\r\n  if (!this.config.useCSStransitions)  {\r\n\r\n    console.log(\"css transitions are disabled\");\r\n\r\n    this.utils.createCSSClass(\r\n      \"#\" + this.config.labels.GAME_ID + \" * \",\r\n      \"transition: none !important;\"\r\n    );\r\n\r\n  }\r\n\r\n  /*\r\n    if the device supports it use 3D transforms \r\n    (which should be hardware accellerated) \r\n    instead of 2D transforms\r\n   */\r\n  this.config.use3Dtransforms = Modernizr.csstransforms3d;\r\n\r\n\r\n  /*\r\n    if the devive supports it, use HTML5 \r\n    localStorage to save games\r\n   */\r\n  this.config.useLstorage = Modernizr.localstorage;\r\n\r\n\r\n  this.config.useVibration = true;\r\n\r\n\r\n  /*\r\n    if the devive supports it, use CSS3 \r\n    animations\r\n   */\r\n  this.config.useCssAnimations = Modernizr.cssanimations;\r\n\r\n\r\n  /*\r\n    detects Safari fullscreen mode (for ex. \r\n    launched as app from home screen)\r\n   */\r\n  this.config.launchedAsApp = this.utils.detectFullscreen();\r\n\r\n\r\n  /*\r\n    list of browser vendors prefixes to \r\n    support for CSS3 properties    \r\n   */\r\n  this.config.browserPrefixes = this.utils.getBrowserPrefix();\r\n\r\n\r\n  /*\r\n    will use RAF when supported by the browser\r\n  */\r\n  this.config.useReqAnimFrame = !!window.requestAnimationFrame;\r\n\r\n};\r\n","game.countMove = function() {\r\n  \"use strict\";\r\n  this.runtime.movesCount++;\r\n};\r\n","game.createBoard = function() {\r\n  \"use strict\";\r\n  //    - creates the board, the tiles objects and the html \r\n\r\n  // local vars:\r\n  var boardHTML, //   - - the game main html element \r\n    tile, //    - - each tile object during a loop\r\n    row = 0, //   - - vertical position of each tile, starting from 0\r\n    col = 0; //   - - horizontal position of each tile, starting from 0\r\n\r\n  if (document.getElementById(this.config.labels.BOARD_ID) === null) {\r\n    // create the board html element, assigns it its id attribute and adds it to the game di\r\n    boardHTML = document.createElement(\"div\");\r\n    boardHTML.setAttribute(\"id\", this.config.labels.BOARD_ID);\r\n\r\n    document.getElementById(this.config.labels.GAME_ID).appendChild(boardHTML); // the board is now in the DOM  \r\n\r\n  } else {\r\n\r\n    document.getElementById(this.config.labels.BOARD_ID).innerHTML = \"\";\r\n\r\n  };\r\n\r\n\r\n  /**\r\n   * TODO: handle re-creation of the board with different sizes\r\n   */\r\n\r\n\r\n  // update game config with the total number of tiles\r\n  this.config.size.n = this.config.size.h * this.config.size.v;\r\n\r\n  // save the index of the last tile as the \"hole\" during the game\r\n  this.config.labels.HOLE_INDEX = this.config.size.n - 1;\r\n\r\n\r\n  // populates the board with the tiles\r\n  for (var i = 0; i < this.config.size.n; i++) // repeat until (n) are created\r\n  {\r\n    //  create a new tile \r\n    tile = {\r\n      i: i, // the index of the tile\r\n      id: this.config.labels.TILE_PREFIX + i, // the id of this tile in the html\r\n      col: col, // horizontal position during the game\r\n      row: row, // vertical position during the game\r\n      correctCol: col, // horizontal position when the game is won\r\n      correctRow: row, // vertical position when the game is won\r\n      even: (i % 2 === 0) ? true : false, //\r\n      evenCol: ((col % 2 === 0)) ? true : false,\r\n      evenRow: ((row % 2 === 0)) ? true : false\r\n    };\r\n\r\n    tile.htmlElement = document.createElement(\"div\");\r\n\r\n    tile.htmlElement.setAttribute(\"id\", this.config.labels.TILE_PREFIX + i);\r\n    tile.htmlElement.setAttribute(\"tabindex\", i);\r\n    tile.htmlElement.setAttribute(\"class\", \" tile\" +\r\n      ((tile.evenRow) ? \" even-row\" : \" odd-row\") +\r\n      ((tile.evenCol) ? \" even-col\" : \" odd-col\") +\r\n      ((tile.even) ? \" even\" : \" odd\") +\r\n      ((i === this.config.labels.HOLE_INDEX) ? \" hole\" : \"\") +\r\n      \" col-\" + col +\r\n      \" row-\" + row\r\n    );\r\n    tile.htmlElement.innerHTML = '<div class=\"' + this.config.labels.TILE_INNER_CLASS + '\"><div class=\"' + this.config.labels.TILE_NUMBER_CLASS + '\">' + (i + 1) + '</div></div>';\r\n\r\n    this.runtime.tiles[this.config.labels.TILE_PREFIX + i] = tile;\r\n\r\n    document.getElementById(this.config.labels.BOARD_ID).appendChild(tile.htmlElement);\r\n\r\n    col++;\r\n    if (col >= this.config.size.h) {\r\n      row++;\r\n      col = 0;\r\n    };\r\n  };\r\n\r\n  this.saveGame(this.config.labels.SORTEDSAVE_LABEL);\r\n\r\n};\r\n","game.deselectTile = function() {\r\n  \"use strict\";\r\n\r\n  var tile = this.isTile(this.runtime.selectedTile);\r\n  var tilesMoved = 0;\r\n\r\n  if (!tile) {\r\n    return false;\r\n  };\r\n\r\n  console.log(\"de-selecting\");\r\n  this.runtime.selectedTile = null;\r\n  this.utils.removeClass(tile.htmlElement, this.config.labels.SELECTED_LABEL);\r\n  this.utils.removeClass(tile.htmlElement, this.config.labels.PRESSED_LABEL);\r\n  this.runtime.dragging = false;\r\n  this.vibrate(\"deselect\");\r\n\r\n  if (typeof tile.newPosition === \"undefined\") {\r\n    return false;\r\n  };\r\n\r\n\r\n  // has the tile been moved?\r\n  if (tile.newPosition.left.newValue.pixels !== null) {\r\n\r\n    console.log(\"the tile has been moved.\")\r\n\r\n    if ((this.config.pushMultiple && !!tile.canPush)) {\r\n\r\n      console.log(\"the tile could push other tiles, so it must have pushed them.\");\r\n\r\n      for (var i = tile.canPush.tiles.length; i > 0; i--) {\r\n        if (!tile.canPush.tiles[0].revert) {\r\n          tilesMoved++;\r\n          this.moveTile(\r\n            tile.canPush.tiles[i - 1], {\r\n              transitions: true,\r\n              force: false,\r\n              refresh: false\r\n            }\r\n          );\r\n        };\r\n        //  this.utils.removeClass(tile.canPush.tiles[i - 1].htmlElement, this.config.labels.SELECTED_LABEL);\r\n      };\r\n\r\n    }\r\n\r\n    console.log(\"now, the tile has been released far enough to its original position in order to move it?\")\r\n\r\n    if (\r\n      (Math.abs(tile.newPosition.left.newValue.pixels - tile.oldPosition.left.pixels) >= this.metrics.tileWidth * this.config.minDistanceToMoveTile) ||\r\n      (Math.abs(tile.newPosition.top.newValue.pixels - tile.oldPosition.top.pixels) >= this.metrics.tileHeight * this.config.minDistanceToMoveTile)\r\n    ) {\r\n\r\n      console.log(\"yes, it's far enough. \")\r\n\r\n      tilesMoved++;\r\n\r\n      this.moveTile(\r\n        tile, {\r\n          transitions: true,\r\n          force: false,\r\n          refresh: false\r\n        }\r\n      );\r\n    } else {\r\n      console.log(\"nope, snapping back \")\r\n    };\r\n\r\n\r\n\r\n  } else {\r\n\r\n    console.log(\"tile has not been moved at all.\")\r\n\r\n    if (this.config.clickToMove) {\r\n\r\n      if (tile.canMove || (this.config.pushMultiple && !!tile.canPush)) {\r\n        for (var i = tile.canPush.tiles.length; i > 0; i--) {\r\n          tilesMoved++;\r\n          this.moveTile(\r\n            tile.canPush.tiles[i - 1], {\r\n              transitions: true,\r\n              force: false,\r\n              refresh: false\r\n            }\r\n          );\r\n          //    this.utils.removeClass(tile.canPush.tiles[i - 1].htmlElement, this.config.labels.SELECTED_LABEL);\r\n        };\r\n\r\n        tilesMoved++;\r\n        this.moveTile(\r\n          tile, {\r\n            transitions: true,\r\n            force: false,\r\n            refresh: false\r\n          }\r\n        );\r\n\r\n\r\n      };\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n  console.log(\"tiles moved: \" + tilesMoved);\r\n\r\n  this.refresh({\r\n    saveGame: !!tilesMoved\r\n  });\r\n\r\n};\r\n","game.dragTile = function(event) {\r\n  \"use strict\";\r\n\r\n  if (!this.runtime.running) {\r\n    this.deselectTile();\r\n    return false;\r\n  }\r\n\r\n  var tile = this.isTile(this.runtime.selectedTile),\r\n    direction,\r\n    newPosX,\r\n    newPosY,\r\n    otherTile,\r\n    otherTileNewPos,\r\n    CSSstyleDeclaration = \"\",\r\n    p;\r\n\r\n  if (!tile ||\r\n    (!!!tile.canMove && !tile.canPush.n) ||\r\n    (typeof tile.offset === \"undefined\") ||\r\n    (typeof tile.newPosition === \"undefined\")\r\n  ) {\r\n    this.deselectTile();\r\n    return false;\r\n  };\r\n\r\n  newPosX = event.pageX - this.metrics.borderSize.pixels - this.metrics.left - tile.offset.left;\r\n  newPosY = event.pageY - this.metrics.borderSize.pixels - this.metrics.top - tile.offset.top;\r\n\r\n  direction = (this.config.pushMultiple && tile.canPush) ? tile.canPush.direction : tile.canMove;\r\n\r\n  if (newPosY < tile.newPosition.top.min.pixels) {\r\n    newPosY = tile.newPosition.top.min.pixels;\r\n  };\r\n  if (newPosY > tile.newPosition.top.max.pixels) {\r\n    newPosY = tile.newPosition.top.max.pixels;\r\n  };\r\n  if (newPosX < tile.newPosition.left.min.pixels) {\r\n    newPosX = tile.newPosition.left.min.pixels;\r\n  };\r\n  if (newPosX > tile.newPosition.left.max.pixels) {\r\n    newPosX = tile.newPosition.left.max.pixels;\r\n  };\r\n\r\n\r\n\r\n  if (\r\n    event.pageX - this.metrics.left - this.metrics.borderSize.pixels + this.metrics.tileWidth * (this.config.touchTolerance) < newPosX ||\r\n    event.pageX - this.metrics.left - this.metrics.borderSize.pixels - this.metrics.tileWidth * (1 + this.config.touchTolerance) > newPosX ||\r\n    event.pageY - this.metrics.top - this.metrics.borderSize.pixels + this.metrics.tileHeight * (this.config.touchTolerance) < newPosY ||\r\n    event.pageY - this.metrics.top - this.metrics.borderSize.pixels - this.metrics.tileHeight * (1 + this.config.touchTolerance) > newPosY\r\n  ) {\r\n\r\n    //    this.vibrate(\"bump\");\r\n    this.deselectTile();\r\n\r\n    // console.log(\"dropped!\");\r\n\r\n    return false;\r\n  }\r\n\r\n  var prefix = \"\";\r\n\r\n  switch (direction) {\r\n\r\n    case this.config.labels.LEFT:\r\n    case this.config.labels.RIGHT:\r\n\r\n      tile.newPosition.top.newValue.pixels = tile.oldPosition.top.pixels;\r\n      tile.newPosition.left.newValue.pixels = newPosX;\r\n\r\n      tile.newPosition.left.newValue.percent = newPosX * 100 / game.metrics.tileWidth;\r\n\r\n      // write the css for tile html element\r\n\r\n      for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n        prefix = this.config.browserPrefixes.css[p];\r\n        CSSstyleDeclaration += prefix + \"transform:translate\" + this.metrics.transforms3Dsupport[0] + \"(\" + tile.newPosition.left.newValue.percent + \"%,\" + tile.oldPosition.top.percent + \"%\" + this.metrics.transforms3Dsupport[1] + \"); \" + prefix + \"transition:none; \";\r\n      }\r\n      break;\r\n\r\n\r\n    case this.config.labels.UP:\r\n    case this.config.labels.DOWN:\r\n\r\n      tile.newPosition.top.newValue.pixels = newPosY;\r\n      tile.newPosition.left.newValue.pixels = tile.oldPosition.left.pixels;\r\n\r\n      tile.newPosition.top.newValue.percent = newPosY * 100 / this.metrics.tileHeight;\r\n\r\n      // write the css for tile html element\r\n      for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n        prefix = this.config.browserPrefixes.css[p];\r\n        CSSstyleDeclaration += prefix + \"transform:translate\" + this.metrics.transforms3Dsupport[0] + \"(\" + tile.oldPosition.left.percent + \"%,\" + tile.newPosition.top.newValue.percent + \"%\" + game.metrics.transforms3Dsupport[1] + \"); \" + prefix + \"transition:none; \";\r\n      }\r\n      break;\r\n\r\n  }\r\n\r\n  if (!!this.config.useReqAnimFrame) {\r\n    this.addMovingTile(tile, CSSstyleDeclaration);\r\n    window.requestAnimationFrame(game.renderMovingTiles);\r\n  } else {\r\n    tile.htmlElement.style.cssText = CSSstyleDeclaration;\r\n  }\r\n\r\n  if (!this.config.pushMultiple || typeof tile.canPush.tiles === \"undefined\") {\r\n    return;\r\n  }\r\n\r\n  for (var i = 0; i < tile.canPush.tiles.length; i++) {\r\n\r\n    otherTile = tile.canPush.tiles[i];\r\n    prefix = \"\";\r\n\r\n    switch (direction) {\r\n      case this.config.labels.UP:\r\n\r\n        otherTileNewPos = (tile.newPosition.top.newValue.pixels - (this.metrics\r\n          .tileHeight * (i + 1)));\r\n\r\n        if (\r\n          otherTileNewPos < tile.canPush.tiles[i].max ||\r\n          tile.canPush.tiles[i].max == null) {\r\n          tile.canPush.tiles[i].max = otherTileNewPos;\r\n        } else {\r\n          return false;\r\n        }\r\n\r\n        // write the css for tile html element\r\n\r\n        for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n          prefix = this.config.browserPrefixes.css[p];\r\n          CSSstyleDeclaration += prefix + \"transform:translate\" + this.metrics\r\n            .transforms3Dsupport[0] + \"(\" + tile.oldPosition.left.percent +\r\n            \"%,\" + otherTileNewPos + \"px\" + this.metrics.transforms3Dsupport[\r\n              1] + \"); \" + prefix + \"transition:none; \";\r\n        }\r\n\r\n        break;\r\n\r\n      case this.config.labels.RIGHT:\r\n\r\n        otherTileNewPos = (tile.newPosition.left.newValue.pixels +\r\n          (\r\n            this.metrics.tileWidth * (i + 1)));\r\n        if (otherTileNewPos > tile.canPush.tiles[i].max || tile.canPush\r\n          .tiles[i].max == null) {\r\n          tile.canPush.tiles[i].max = otherTileNewPos;\r\n        } else {\r\n          return false;\r\n        }\r\n\r\n        // write the css for tile html element\r\n        for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n          prefix = this.config.browserPrefixes.css[p];\r\n          CSSstyleDeclaration += prefix + \"transform:translate\" +\r\n            this.metrics\r\n            .transforms3Dsupport[0] + \"(\" + otherTileNewPos + \"px,\" +\r\n            tile.oldPosition.top.percent + \"%\" + this.metrics.transforms3Dsupport[\r\n              1] + \"); \" + prefix + \"transition:none; \";\r\n        }\r\n        break;\r\n\r\n      case this.config.labels.DOWN:\r\n\r\n        otherTileNewPos = (tile.newPosition.top.newValue.pixels + (\r\n          game\r\n          .metrics.tileHeight * (i + 1)));\r\n        if (otherTileNewPos > tile.canPush.tiles[i].max || tile.canPush\r\n          .tiles[i].max == null) {\r\n          tile.canPush.tiles[i].max = otherTileNewPos;\r\n        } else {\r\n          return false;\r\n        }\r\n\r\n        // write the css for tile html element\r\n        for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n          prefix = this.config.browserPrefixes.css[p];\r\n          CSSstyleDeclaration += prefix + \"transform:translate\" +\r\n            this.metrics\r\n            .transforms3Dsupport[0] + \"(\" + tile.oldPosition.left.percent +\r\n            \"%,\" + otherTileNewPos + \"px\" + this.metrics.transforms3Dsupport[\r\n              1] + \"); \" + prefix + \"transition:none; \";\r\n        }\r\n\r\n\r\n        break;\r\n\r\n      case this.config.labels.LEFT:\r\n\r\n        otherTileNewPos = (tile.newPosition.left.newValue.pixels -\r\n          (\r\n            this.metrics.tileWidth * (i + 1)));\r\n        if (otherTileNewPos < tile.canPush.tiles[i].max || tile.canPush\r\n          .tiles[i].max == null) {\r\n          tile.canPush.tiles[i].max = otherTileNewPos;\r\n        } else {\r\n          return false;\r\n        }\r\n\r\n        // write the css for tile html element\r\n        for (p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n          prefix = this.config.browserPrefixes.css[p];\r\n          CSSstyleDeclaration += prefix + \"transform:translate\" +\r\n            this.metrics\r\n            .transforms3Dsupport[0] + \"(\" + otherTileNewPos + \"px,\" +\r\n            tile.oldPosition.top.percent + \"%\" + this.metrics.transforms3Dsupport[\r\n              1] + \"); \" + prefix + \"transition:none; \";\r\n        }\r\n\r\n        break;\r\n\r\n    }\r\n\r\n    if (!!this.config.useReqAnimFrame) {\r\n      this.addMovingTile(otherTile, CSSstyleDeclaration);\r\n      window.requestAnimationFrame(game.renderMovingTiles);\r\n    } else {\r\n      otherTile.htmlElement.style.cssText = CSSstyleDeclaration;\r\n    }\r\n\r\n    if (\r\n      (Math.abs(tile.newPosition.left.newValue.pixels - tile.oldPosition.left.pixels) >= this.metrics.tileWidth * this.config.minDistanceToMoveTile) ||\r\n      (Math.abs(tile.newPosition.top.newValue.pixels - tile.oldPosition.top.pixels) >= this.metrics.tileHeight * this.config.minDistanceToMoveTile)\r\n    ) {\r\n      otherTile.revert = false;\r\n    } else {\r\n      otherTile.revert = true;\r\n    }\r\n\r\n  }\r\n\r\n};\r\n","game.getMovableTiles = function(params) {\r\n  \"use strict\";\r\n  var direction = params.direction,\r\n    pushing = params.pushing,\r\n    moving = params.moving,\r\n    t;\r\n\r\n  this.runtime.movableTiles = [];\r\n\r\n  if (this.runtime.running || params.force === true) {\r\n    for (var i = 0; i < this.config.size.n; i++) {\r\n      t = this.runtime.tiles[\"tile-\" + i];\r\n\r\n      if (!!t.canMove && moving && (typeof direction === \"undefined\" ||\r\n          direction === t.canMove)) {\r\n        this.runtime.movableTiles.push(this.getTile(this.config.labels.TILE_PREFIX +\r\n          t.i));\r\n      };\r\n\r\n      if (this.config.pushMultiple && pushing && !!t.canPush && !t.canMove &&\r\n        (typeof direction === \"undefined\" || direction === t.canPush.direction)\r\n      ) {\r\n        this.runtime.movableTiles.push(this.getTile(this.config.labels.TILE_PREFIX +\r\n          t.i));\r\n      };\r\n    }\r\n\r\n  };\r\n  return this.runtime.movableTiles;\r\n};\r\n","game.getTile = function(param) {\r\n  \"use strict\";\r\n\r\n  var target = null,\r\n    maxLevels = 5,\r\n    tiles = this.runtime.tiles,\r\n    col = parseInt(param.col),\r\n    row = parseInt(param.row),\r\n    prefix = this.config.labels.TILE_PREFIX,\r\n    i;\r\n\r\n  switch (typeof param) {\r\n\r\n    case \"object\":\r\n\r\n      if (param.srcElement) {\r\n        target = param.srcElement;\r\n      } else if (param.pageX && param.pageY) {\r\n        target = document.elementFromPoint(param.pageX, param.pageY);\r\n      } else if (!isNaN(parseInt(param.col)) && !isNaN(parseInt(\r\n          param.row))) {\r\n\r\n        for (i = 0; i < this.config.size.n; i++) {\r\n          if (tiles[prefix + i].col === col && tiles[prefix + i].row === row) {\r\n            return tiles[prefix + i];\r\n          }\r\n        }\r\n        return false;\r\n      } else {\r\n        return false;\r\n      }\r\n\r\n      if (target === null) {\r\n        return false;\r\n      }\r\n\r\n      for (i = 0; i < maxLevels; i++) {\r\n\r\n        if (\r\n          typeof target === \"undefined\" ||\r\n          typeof target.parentNode === \"undefined\" ||\r\n          target === null ||\r\n          target.parentNode === null\r\n        ) {\r\n          return false;\r\n        } else if (target.parentNode.id === this.config.labels.BOARD_ID) {\r\n          return this.runtime.tiles[target.id];\r\n        } else {\r\n          target = target.parentNode;\r\n        }\r\n      }\r\n      return false;\r\n\r\n      break;\r\n\r\n    case \"string\":\r\n      if (param.indexOf(prefix) === 0) {\r\n        return tiles[param];\r\n      }\r\n      return false;\r\n\r\n    case \"number\":\r\n      if (param < this.config.size.n) {\r\n        return tiles[prefix + param];\r\n      }\r\n      return false;\r\n\r\n\r\n  }\r\n};\r\n","game.init = function() {\r\n  \"use strict\";\r\n\r\n  this.runtime = {\r\n    started: false, // false before running, a date obj when started\r\n    running: false, // true if the game is started (and user can win)    \r\n    ended: false, // false while running, a date obj when ended\r\n    timePlaying: 0, // tbd\r\n    movesCount: false, // number of moves the user has made since the start\r\n    dragging: false, // true when any tile is being dragged\r\n    resizeTimer: -1, // variable needed for the resize timer\r\n    selectedTile: null, // the selected tile object (extends normal tile objects \r\n    tiles: {}, // tiles (associative) array\r\n    latestSelection: 0, // used to ignore doubleclicks\r\n    eventListeners: {},\r\n  };\r\n\r\n  this.checkFeatures();\r\n  this.createBoard(); // creates the board, the tiles objects and the html       \r\n  this.changeBg(); // will load a random background image \r\n  this.metricsUpdate();\r\n  this.initListeners(); // create event listeners enabling user interaction\r\n  this.refresh({\r\n    transitions: false\r\n  }); // position each tile according to the game runtime      \r\n  if (!this.loadGame()) {\r\n    this.newGame(); // repeatedly changes random tiles \r\n  } else {\r\n    this.animate({\r\n      element: document.getElementById(this.config.labels.GAME_ID),\r\n      animation: \"load\",\r\n      duration: 1000\r\n    });\r\n    this.start(); // set the game as started. from this moment on the game checks if the user has won\r\n  }\r\n\r\n};\r\n","game.initListeners = function() {\r\n  \"use strict\";\r\n\r\n  // BEGIN TOUCH/CLICK EVENTS\r\n\r\n  // start/down\r\n  // board\r\n  this.utils.listenTo(\r\n    document.getElementById(this.config.labels.BOARD_ID), (this.config.useTouch ? \"touchstart\" : \"mousedown\"),\r\n    function(event, context) {\r\n\r\n      // ignore doubleclicks  \r\n      if (event.timeStamp - context.runtime.latestSelection < 300) {\r\n        return false;\r\n      }\r\n      context.runtime.latestSelection = event.timeStamp;\r\n\r\n      context.selectTile(context.getTile(event), event);\r\n\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n\r\n\r\n\r\n\r\n  // ignore swipes outside the board\r\n  this.utils.listenTo(\r\n    document.getElementById(this.config.labels.WRAPPER_ID), (this.config.useTouch ? \"touchmove\" : \"mousemove\"),\r\n    function(event, context) {\r\n      return false;\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n  // swipes on the board;\r\n  this.utils.listenTo(\r\n    document.getElementById(this.config.labels.BOARD_ID), (this.config.useTouch ? \"touchmove\" : \"mousemove\"),\r\n    function(event, context) {\r\n\r\n\r\n      if (!!context.runtime.selectedTile) {\r\n        context.dragTile(event);\r\n      } else if (event.type !== \"mousemove\") {\r\n\r\n        // ignore doubleclicks  \r\n        if (event.timeStamp - context.runtime.latestSelection < 300) {\r\n          return false;\r\n        }\r\n        context.runtime.latestSelection = event.timeStamp;\r\n\r\n        context.selectTile(context.getTile(event), event);\r\n      }\r\n\r\n\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n\r\n\r\n  //  end/up\r\n  this.utils.listenTo(\r\n    document.getElementById(this.config.labels.WRAPPER_ID), (this.config.useTouch ? \"touchend\" : \"mouseup\"),\r\n    function(event, context) {\r\n\r\n      if (typeof context.runtime.selectedTile === \"undefined\" || context.runtime.selectedTile === null) {\r\n        return false;\r\n      }\r\n\r\n      if (context.config.useTouch && ((event.timeStamp - context.runtime.selectedTile.timeStamp) > context.config.maxTimeForClickMove)) {\r\n\r\n        if (\r\n          context.runtime.selectedTile.newPosition.top.newValue.pixels === null &&\r\n          context.runtime.selectedTile.newPosition.left.newValue.pixels === null\r\n        ) {\r\n          context.runtime.selectedTile.newPosition = undefined;\r\n        }\r\n      };\r\n\r\n      context.deselectTile();\r\n\r\n    },\r\n    this.runtime.eventListeners,\r\n    this);\r\n\r\n  // mouseout\r\n  this.utils.listenTo(\r\n    document.getElementById(this.config.labels.GAME_ID),\r\n    \"mouseout\",\r\n    function(event, context) {\r\n      event = event ? event : window.event;\r\n      var from = event.relatedTarget || event.toElement;\r\n      if (!from || from.nodeName === \"HTML\") {\r\n        context.deselectTile();\r\n      }\r\n    },\r\n    this.runtime.eventListeners,\r\n    this);\r\n\r\n\r\n  // END TOUCH/MOUSE EVENTS\r\n\r\n  if (this.config.useKeyboard) {\r\n    this.utils.listenTo(\r\n      document.body,\r\n      \"keyup\",\r\n      function(event, context) {\r\n\r\n        switch (event.which) {\r\n          case context.config.keycodes.KEY_ARROW_LEFT:\r\n            context.moveAnyTile({\r\n              direction: context.config.labels.LEFT,\r\n              pushing: event.ctrlKey\r\n            });\r\n            break;\r\n\r\n          case context.config.keycodes.KEY_ARROW_UP:\r\n            context.moveAnyTile({\r\n              direction: context.config.labels.UP,\r\n              pushing: event.ctrlKey\r\n            });\r\n            break;\r\n\r\n          case context.config.keycodes.KEY_ARROW_RIGHT:\r\n            context.moveAnyTile({\r\n              direction: context.config.labels.RIGHT,\r\n              pushing: event.ctrlKey\r\n            });\r\n            break;\r\n\r\n          case context.config.keycodes.KEY_ARROW_DOWN:\r\n            context.moveAnyTile({\r\n              direction: context.config.labels.DOWN,\r\n              pushing: event.ctrlKey\r\n            });\r\n            break;\r\n\r\n        }\r\n\r\n      },\r\n      this.runtime.eventListeners,\r\n      this);\r\n  }\r\n\r\n  // resize event will fire a layoutChange event\r\n  this.utils.listenTo(window,\r\n    \"resize\",\r\n    function(event, context) {\r\n\r\n      var event = new Event('layoutChange');\r\n      window.dispatchEvent(event);\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n  // resize event will fire a layoutChange event\r\n  this.utils.listenTo(window,\r\n    \"orientationchange\",\r\n    function(event, context) {\r\n\r\n      var event = new Event('layoutChange');\r\n      window.dispatchEvent(event);\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n\r\n  // layoutChange custom event: fired when resized or rotated\r\n  this.utils.listenTo(window,\r\n    \"layoutChange\",\r\n    function(event, context) {\r\n\r\n      context.optimizeRedraws(\"on\");\r\n\r\n      if (context.runtime.resizeTimer !== -1) {\r\n        clearTimeout(context.runtime.resizeTimer);\r\n      }\r\n\r\n      context.runtime.resizeTimer = window.setTimeout(function(context) {\r\n\r\n        if (typeof context !== \"undefined\") {\r\n          context.deselectTile();\r\n          context.metricsUpdate();\r\n          context.refresh();\r\n          context.optimizeRedraws(\"off\");\r\n        }\r\n\r\n      }, 500, context);\r\n\r\n    },\r\n    this.runtime.eventListeners,\r\n    this);\r\n\r\n};\r\n","game.isTile = function(tile) {\r\n  \"use strict\";\r\n\r\n  if (tile === null || tile === undefined) {\r\n    return false;\r\n  }\r\n\r\n  switch (typeof tile) {\r\n    case \"object\":\r\n      if (tile.id.indexOf(this.config.labels.TILE_PREFIX) < 0) {\r\n        return false;\r\n      }\r\n      break;\r\n\r\n    case \"string\":\r\n      tile = this.runtime.tiles[tile];\r\n      if (typeof tile === \"undefined\") {\r\n        return false;\r\n      };\r\n      if (tile.id.indexOf(this.config.labels.TILE_PREFIX) < 0) {\r\n        return false;\r\n      };\r\n      break;\r\n\r\n    default:\r\n      return false;\r\n      break;\r\n  }\r\n  return tile;\r\n};\r\n","game.loadGame = function(type) {\r\n  \"use strict\";\r\n  if (!this.config.useLstorage) {\r\n    return false;\r\n  }\r\n  if (typeof type === \"undefined\") {\r\n    type = this.config.labels.AUTOSAVE_LABEL;\r\n  }\r\n\r\n  var loadedGames = JSON.parse(localStorage.getItem(this.config.labels.SAVEDGAMES_LABEL));\r\n  var loadedGame = null;\r\n  var tileID;\r\n\r\n  if (loadedGames !== null) {\r\n    if (typeof loadedGames[type] !== \"undefined\" && loadedGames[type] !==\r\n      null) {\r\n      loadedGame = loadedGames[type];\r\n\r\n      loadedGame.saveDate = new Date(Date.UTC.apply(this,\r\n        loadedGame.saveDate.match(/\\d+\\.{0,1}\\d+/g)));\r\n\r\n\r\n      if (loadedGame.startedDate) {\r\n        loadedGame.startedDate = new Date(Date.UTC.apply(this,\r\n          loadedGame.startedDate.match(/\\d+\\.{0,1}\\d+/g)));\r\n      }\r\n\r\n      if (loadedGame.size !== this.config.size.n) {\r\n        console.log(\"cannot load game: different sizes:\",\r\n          loadedGame.size, this.config.size.n);\r\n        return false;\r\n      }\r\n\r\n      this.runtime.tiles = loadedGame.tiles;\r\n\r\n\r\n      for (var i = 0; i < this.config.size.n; i++) {\r\n\r\n        tileID = this.config.labels.TILE_PREFIX + i;\r\n        loadedGame.tiles[tileID].htmlElement = document.getElementById(\r\n          tileID);\r\n      }\r\n\r\n      this.runtime.started = loadedGame.startedDate;\r\n      this.runtime.movesCount = parseInt(loadedGame.movesCount);\r\n      this.refresh({\r\n        transitions: (type === \"user\")\r\n      });\r\n\r\n      console.log(\"game loaded\");\r\n      return true;\r\n    }\r\n\r\n    console.log(\"cannot find saved game '\" + type + \"'\");\r\n    return false;\r\n\r\n  }\r\n\r\n  console.log(\"cannot find any saved game\");\r\n  return false;\r\n};\r\n","game.metricsUpdate = function() {\r\n  \"use strict\";\r\n\r\n  this.metrics = this.metrics || {};\r\n\r\n  var wrapperHTML = document.getElementById(this.config.labels.WRAPPER_ID); // main wrapper html element\r\n  var gameHTML = document.getElementById(this.config.labels.GAME_ID); // game div html element\r\n  var wrapperWidth = wrapperHTML.offsetWidth;\r\n  var wrapperHeight = wrapperHTML.offsetHeight;\r\n  var cssPrefix = \"#\" + this.config.labels.BOARD_ID;\r\n\r\n  // save values in metrics obj\r\n  this.metrics.transforms3Dsupport = (this.config.use3Dtransforms) ? [\"3d\", \",0\"] : [\"\", \"\"]; // allows transformations 2d and 3d \r\n  this.metrics.wrapperOrientation = (wrapperWidth >= wrapperHeight) ? this.config.labels.LANDSCAPE : this.config.labels.PORTRAIT;\r\n  this.metrics.wrapperRatio = wrapperWidth / wrapperHeight;\r\n  this.metrics.pixelRatio = (window.devicePixelRatio > 1) ? window.devicePixelRatio : 1;\r\n\r\n\r\n  // if it doesn't exists yet, create wrapperSize obj\r\n  if (typeof this.metrics.wrapperSize === \"undefined\") {\r\n    this.metrics.wrapperSize = {};\r\n  };\r\n\r\n  // if it doesn't exist yet, create a sub-obj for storing metric sinformation for each screen orientation    \r\n  this.metrics.wrapperSize[this.metrics.wrapperOrientation] = {\r\n    width: wrapperWidth,\r\n    height: wrapperHeight,\r\n  };\r\n\r\n  // this is info about the board configuration\r\n  this.metrics.boardLayout = (this.config.size.h >= this.config.size.v) ? this.config.labels.LANDSCAPE : this.config.labels.PORTRAIT;\r\n  this.metrics.boardRatio = this.config.size.h / this.config.size.v;\r\n\r\n  // this is a pragmatic way to calculate a good font size for tile numbers\r\n  this.metrics.fontSize = parseInt((document.body.currentStyle || (window.getComputedStyle && getComputedStyle(document.body, null)) || document.body.style).fontSize);\r\n\r\n  // initialize the margin around the game board\r\n  this.metrics.marginH = {\r\n    percent: this.config.margin.h,\r\n    pixels: 0\r\n  };\r\n\r\n  // initialize the margin around the game board\r\n  this.metrics.marginV = {\r\n    percent: this.config.margin.v,\r\n    pixels: 0\r\n  };\r\n\r\n  // initialize the bezel around the game board\r\n  this.metrics.borderSize = {\r\n    percent: this.config.borderSize,\r\n    pixels: 0\r\n  };\r\n\r\n  // depending on orientation, calculate board size to optimize space\r\n  // board will always be a square, so calculate width first\r\n  if (this.metrics.wrapperOrientation === this.config.labels.LANDSCAPE) {\r\n\r\n    this.metrics.height = this.utils.roundTo(wrapperHeight / 100 * (100 - this.config.borderSize * 2 - this.metrics.marginV.percent * 2), this.config.size.h);\r\n    this.metrics.width = this.metrics.height;\r\n\r\n    this.metrics.borderSize.pixels = Math.round(wrapperHeight / 100 * this.config.borderSize);\r\n    this.metrics.marginH.pixels = Math.round(wrapperHeight / 100 * this.metrics.marginH.percent);\r\n    this.metrics.marginV.pixels = Math.round(wrapperHeight / 100 * this.metrics.marginV.percent);\r\n\r\n    this.metrics.left = Math.round((wrapperWidth - this.metrics.width - this.metrics.borderSize.pixels - this.metrics.marginH.pixels) / 2);\r\n    this.metrics.top = Math.round((this.metrics.wrapperSize[this.metrics.wrapperOrientation].height - this.metrics.height - this.metrics.borderSize.pixels - this.metrics.marginV.pixels) / 2);\r\n\r\n  } else {\r\n\r\n    this.metrics.width = this.utils.roundTo(wrapperWidth / 100 * (100 - this.config.borderSize * 2 - this.metrics.marginH.percent * 2), this.config.size.v);\r\n    this.metrics.height = this.metrics.width;\r\n\r\n    this.metrics.borderSize.pixels = Math.round(wrapperWidth / 100 * this.config.borderSize);\r\n    this.metrics.marginH.pixels = Math.round(wrapperWidth / 100 * this.metrics.marginH.percent);\r\n    this.metrics.marginV.pixels = Math.round(wrapperWidth / 100 * this.metrics.marginV.percent);\r\n\r\n    this.metrics.left = Math.round((wrapperWidth - this.metrics.width - this.metrics.borderSize.pixels - this.metrics.marginH.pixels) / 2);\r\n    this.metrics.top = Math.round((this.metrics.wrapperSize[this.metrics.wrapperOrientation].height - this.metrics.height - this.metrics.borderSize.pixels - this.metrics.marginV.pixels) / 2);\r\n\r\n  }\r\n\r\n  // with the board size, get the tile size\r\n  this.metrics.tileWidth = Math.round(this.metrics.width / this.config.size.h);\r\n  this.metrics.tileHeight = Math.round(this.metrics.height / this.config.size.v);\r\n\r\n\r\n  // WRITING PHASE\r\n\r\n  // write the css for game html element\r\n\r\n  var CSSstyleDeclaration = \"\" + \"padding:\" + Math.round(this.metrics.borderSize.pixels) + \"px;\" + \"width:\" + this.metrics.width + \"px; \" + \"height:\" + this.metrics.height + \"px; \" + \"left:\" + this.metrics.left + \"px; \" + \"top:\" + this.metrics.top + \"px; \";\r\n\r\n  if (typeof game.runtime.backgroundImage !== \"undefined\") {\r\n    var rgb = game.runtime.backgroundImage.averageRGB_brighter;\r\n    if (typeof rgb === \"object\") {\r\n      CSSstyleDeclaration += \"background-color: rgb(\" + rgb.r + \",\" + rgb.g + \",\" + rgb.b + \");\"\r\n    };\r\n  };\r\n\r\n  gameHTML.style.cssText = CSSstyleDeclaration;\r\n\r\n  // font size (used both for numbers, spacing and borders)\r\n\r\n  document.getElementById(this.config.labels.GAME_ID).style.fontSize = \"\" + document.getElementById(this.config.labels.BOARD_ID).offsetHeight / this.config.size.v / 2 + \"px\";\r\n\r\n\r\n  // css for tile\r\n  var tileWpc = (100 / this.config.size.h) + \"%\";\r\n  var tileHpc = (100 / this.config.size.v) + \"%\";\r\n\r\n  // if the class rule is not present..\r\n  if (this.utils.editCSSRule(cssPrefix + \" .\" + this.config.labels.TILE_CLASS) === null) {\r\n\r\n    // ...create it\r\n    this.utils.createCSSClass(cssPrefix + \" .\" + this.config.labels.TILE_CLASS,\r\n      \"width: \" + tileWpc + \"; height: \" + tileHpc + \";\"\r\n    );\r\n\r\n  } else {\r\n\r\n    // ...or updated it\r\n    this.utils.editCSSRule(cssPrefix + \" .\" + this.config.labels.TILE_CLASS, \"width\", tileWpc);\r\n    this.utils.editCSSRule(cssPrefix + \" .\" + this.config.labels.TILE_CLASS, \"height\", tileHpc);\r\n\r\n  };\r\n\r\n  // same for inner class\r\n  var bgSize = \"auto \" + this.metrics.height + \"px\";\r\n\r\n  if (this.utils.editCSSRule(cssPrefix + \" .\" + this.config.labels.TILE_INNER_CLASS) === null) {\r\n    this.utils.createCSSClass(cssPrefix + \".\" + this.config.labels.TILE_INNER_CLASS, \"background-size: \" + bgSize + \";\");\r\n  } else {\r\n    this.utils.editCSSRule(cssPrefix + \" .\" + this.config.labels.TILE_INNER_CLASS, \"backgroundSize\", bgSize);\r\n  }\r\n\r\n};\r\n","game.moveAnyTile = function(params) {\r\n  \"use strict\";\r\n\r\n  var tiles = (params.pushing === true) ? this.getMovableTiles({\r\n      pushing: false,\r\n      moving: true,\r\n      direction: params.direction\r\n    }).concat(this.getMovableTiles({\r\n      pushing: true,\r\n      moving: false,\r\n      direction: params.direction\r\n    }).sort(function(t1, t2) {\r\n      return t1.canPush.n - t2.canPush.n;\r\n    })) :\r\n    this.getMovableTiles({\r\n      pushing: false,\r\n      moving: true,\r\n      direction: params.direction\r\n    });\r\n  for (var i = 0; i < tiles.length; i++) {\r\n    this.moveTile(tiles[i], {\r\n      transitions: false,\r\n      force: false,\r\n      refresh: false\r\n    });\r\n  }\r\n  this.refresh({\r\n    transitionDuration: this.config.transitionDuration.byKeyboard\r\n  });\r\n\r\n  return tiles;\r\n};\r\n","game.moveTile = function(tile, params) {\r\n  \"use strict\";\r\n\r\n  tile = this.isTile(tile);\r\n  if (!tile) {\r\n    return false;\r\n  };\r\n\r\n  var hole = this.runtime.tiles[this.config.labels.TILE_PREFIX + this.config.labels.HOLE_INDEX];\r\n  var temp = {};\r\n\r\n  if (!this.canMove(tile)) {\r\n    return false;\r\n  }\r\n\r\n  if (params.force !== true) {\r\n    if (!this.runtime.running) {\r\n      return false;\r\n    }\r\n    this.countMove();\r\n  }\r\n\r\n  temp.col = tile.col;\r\n  temp.row = tile.row;\r\n\r\n  tile.col = hole.col;\r\n  tile.row = hole.row;\r\n\r\n  hole.col = temp.col;\r\n  hole.row = temp.row;\r\n\r\n  if (params.refresh === true) {\r\n    this.refresh({\r\n      transitions: params.transitions,\r\n      saveGame: !params.force,\r\n      redraw: !!!params.force\r\n    });\r\n  }\r\n\r\n  return true;\r\n};\r\n","game.newGame = function() {\r\n  \"use strict\";\r\n\r\n  var animationDuration = 2000;\r\n\r\n  if (this.runtime.running) {\r\n    console.log(\"user reset\");\r\n\r\n    this.stop();\r\n\r\n    setTimeout(function(context) {\r\n\r\n      context.loadGame(context.config.labels.SORTEDSAVE_LABEL);\r\n\r\n      context.refresh({\r\n        transitions: false\r\n      });\r\n\r\n      context.saveGame(context.config.labels.SORTEDSAVE_LABEL);\r\n\r\n\r\n    }, animationDuration * 0.34, this);\r\n\r\n    this.animate({\r\n      element: document.getElementById(this.config.labels.GAME_ID),\r\n      animation: \"resetboard\",\r\n      duration: animationDuration,\r\n      easing: \"ease-in-out\"\r\n    });\r\n\r\n  } else {\r\n    console.log(\"first launch\");\r\n\r\n    this.refresh({\r\n      transitions: false\r\n    });\r\n\r\n    this.saveGame(this.config.labels.SORTEDSAVE_LABEL);\r\n\r\n    this.animate({\r\n      element: document.getElementById(this.config.labels.GAME_ID),\r\n      animation: \"intro\",\r\n      duration: animationDuration\r\n    });\r\n\r\n  }\r\n\r\n  setTimeout(function(context) {\r\n\r\n    context.shuffle(context.config.size.n * context.config.size.n);\r\n    context.saveGame(context.config.labels.SHUFFLEDSAVE_LABEL);\r\n    context.start();\r\n\r\n  }, animationDuration * 0.85, this);\r\n};\r\n","game.optimizeRedraws = function(state) {\r\n  \"use strict\";\r\n\r\n  var elements = [\r\n    this.config.labels.WRAPPER_ID,\r\n    this.config.labels.BACKGROUND_CONTAINER_ID,\r\n    this.config.labels.GAME_ID\r\n  ];\r\n\r\n  var i = 0;\r\n\r\n\r\n  if (state == \"on\") {\r\n\r\n    console.log(\"hiding elements during layout change...\")\r\n    for (i = 0; i < elements.length; i++) {\r\n      document.getElementById(elements[i]).style.visibility = \"hidden\";\r\n    }\r\n\r\n  } else {\r\n\r\n    console.log(\"...showing back again elements after layout change\")\r\n    for (i = 0; i < elements.length; i++) {\r\n      document.getElementById(elements[i]).style.visibility = \"visible\";\r\n\r\n    }\r\n\r\n  };\r\n\r\n\r\n}\r\n","game.refresh = function(params) {\r\n  \"use strict\";\r\n\r\n  var tileID,\r\n    tile,\r\n    CSSstyleDeclaration = \"\",\r\n    win = true;\r\n\r\n  if (typeof params === \"undefined\") {\r\n    params = {\r\n      transitions: true,\r\n      saveGame: false\r\n    };\r\n  };\r\n\r\n  if (params.transitions === false) {\r\n    params.transitionDuration = 0;\r\n  } else // transitions = true\r\n  {\r\n    if (typeof params.transitionDuration !== \"number\") {\r\n      params.transitionDuration = this.config.transitionDuration.generic;\r\n    }\r\n  };\r\n\r\n  console.log(\"refresh\", params);\r\n  game.runtime.movingTiles = {};\r\n\r\n  for (var i = 0; i < this.config.size.n; i++) {\r\n\r\n    tileID = this.config.labels.TILE_PREFIX + i;\r\n    tile = this.runtime.tiles[tileID];\r\n\r\n    // write the css for tile html element\r\n    var prefix = \"\";\r\n    for (var p = 0; p < this.config.browserPrefixes.css.length; p++) {\r\n\r\n      prefix = this.config.browserPrefixes.css[p];\r\n\r\n      CSSstyleDeclaration += prefix + \"transform:translate\" + this.metrics.transforms3Dsupport[0] + \"(\" + (tile.col * 100) + \"%,\" + (tile.row * 100) + \"%\" + this.metrics.transforms3Dsupport[1] + \"); \";\r\n      CSSstyleDeclaration += prefix + \"transition-property:\" + prefix + \"transform;\";\r\n      CSSstyleDeclaration += prefix + \"transition-duration:\" + parseInt(Math.abs(params.transitionDuration)) + \"ms !important;\";\r\n      CSSstyleDeclaration += prefix + \"transition-timing-function:\" + this.config.easings.EASING_TILES_MOVEMENT + \";\";\r\n    }\r\n\r\n\r\n    if (params.redraw !== false) {\r\n      tile.htmlElement.style.cssText = CSSstyleDeclaration;\r\n    }\r\n\r\n    tile.htmlElement.childNodes[0].style.backgroundPosition = \"-\" + (tile.correctCol * this.metrics.tileWidth) + \"px -\" + (tile.correctRow * this.metrics.tileHeight) + \"px\";\r\n\r\n    tile.canMove = this.canMove(tileID);\r\n    tile.canPush = this.canPush(tileID);\r\n\r\n    // clean up data created when dragging or moving a tile\r\n    tile.offse = undefined;\r\n    tile.newPosition = undefined;\r\n    tile.oldPosition = undefined;\r\n    tile.timeStamp = undefined;\r\n    tile.revert = undefined;\r\n    tile.max = undefined;\r\n\r\n    // check if the user has won\r\n    if (tile.correctCol !== tile.col || tile.correctRow !== tile.row) {\r\n      win = false;\r\n    }\r\n\r\n  };\r\n\r\n  if (this.runtime.running && win /* && this.runtime.movesCount > 0 */ ) {\r\n    setTimeout(function() {\r\n      window.alert(\"Hai vinto!\");\r\n    }, 500);\r\n    this.stop();\r\n\r\n    this.newGame();\r\n  }\r\n\r\n  if (params.saveGame === true) {\r\n    this.saveGame();\r\n  }\r\n};\r\n","game.addMovingTile = function(tileObj, cssString) {\r\n  \"use strict\";\r\n\r\n  if (typeof this.runtime.movingTiles !== \"object\") {\r\n    this.runtime.movingTiles = {};\r\n  }\r\n\r\n  this.runtime.movingTiles[tileObj.id] = cssString;\r\n  return this.runtime.movingTiles;\r\n\r\n};\r\n\r\n\r\ngame.renderMovingTiles = function() {\r\n\r\n  var movingTiles = game.runtime.movingTiles;\r\n\r\n  for (tileId in movingTiles) {\r\n    if (!!movingTiles[tileId]) {\r\n      console.log(\"--- moving \" + tileId)\r\n      game.runtime.tiles[tileId].htmlElement.style.cssText = movingTiles[tileId];\r\n    }\r\n  }\r\n  game.runtime.movingTiles = {};\r\n\r\n  return game.runtime.movingTiles;\r\n\r\n}\r\n","game.saveGame = function(type) {\r\n  \"use strict\";\r\n  if (!this.config.useLstorage) {\r\n    return false;\r\n  }\r\n  if (this.runtime.ended !== false) {\r\n    return false;\r\n  }\r\n  if (typeof type === \"undefined\") {\r\n    type = this.config.labels.AUTOSAVE_LABEL;\r\n  }\r\n\r\n  var savedGames = {};\r\n  var savedGame = {\r\n    saveDate: new Date().toUTCString(),\r\n    type: type,\r\n    size: this.config.size.n,\r\n    tiles: {},\r\n    movesCount: this.runtime.movesCount\r\n  };\r\n  var tileID;\r\n\r\n  if (JSON.parse(localStorage.getItem(this.config.labels.SAVEDGAMES_LABEL)) != null) {\r\n    savedGames = JSON.parse(localStorage.getItem(this.config.labels.SAVEDGAMES_LABEL));\r\n  }\r\n\r\n  if (this.runtime.started) {\r\n    savedGame.startedDate = this.runtime.started.toUTCString();\r\n  }\r\n\r\n  for (var i = 0; i < this.config.size.n; i++) {\r\n\r\n    tileID = this.config.labels.TILE_PREFIX + i;\r\n    savedGame.tiles[tileID] = this.utils.cloneObj(this.runtime.tiles[tileID]);\r\n  }\r\n\r\n  savedGames[type] = savedGame;\r\n\r\n  localStorage.setItem(this.config.labels.SAVEDGAMES_LABEL, JSON.stringify(savedGames));\r\n\r\n  console.log(\"game saved (\" + type + \")\");\r\n};\r\n","game.selectTile = function(tile, event) {\r\n  \"use strict\";\r\n\r\n  if (!this.runtime.running) {\r\n    return false;\r\n  }\r\n\r\n  tile = this.isTile(tile);\r\n\r\n  if (!tile) {\r\n    return false;\r\n  };\r\n\r\n  var direction = (this.config.pushMultiple && tile.canPush) ? tile.canPush.direction : tile.canMove;\r\n\r\n  this.runtime.selectedTile = tile;\r\n\r\n  if (this.canMove(tile) || this.config.pushMultiple) {\r\n\r\n    this.runtime.selectedTile.timeStamp = (typeof event !== \"undefined\") ? event.timeStamp : new Date();\r\n\r\n    this.runtime.selectedTile.oldPosition = {\r\n\r\n      left: {\r\n        percent: 100 * tile.col,\r\n        pixels: this.metrics.tileWidth * tile.col\r\n      },\r\n      top: {\r\n        percent: 100 * tile.row,\r\n        pixels: this.metrics.tileHeight * tile.row\r\n      }\r\n\r\n    };\r\n    this.runtime.selectedTile.offset = (typeof event !== \"undefined\") ? {\r\n      top: ((event.pageY - this.metrics.top - this.metrics.borderSize.pixels) % this.metrics.tileHeight),\r\n      left: ((event.pageX - this.metrics.left - this.metrics.borderSize.pixels) % this.metrics.tileWidth)\r\n    } : {\r\n      top: this.metrics.tileHeight / 2,\r\n      left: this.metrics.tileWidth / 2\r\n    };\r\n\r\n    this.runtime.selectedTile.newPosition = {\r\n      top: {\r\n        min: {\r\n          pixels: null,\r\n          percent: null\r\n        },\r\n        newValue: {\r\n          pixels: null,\r\n          percent: null\r\n        },\r\n        max: {\r\n          pixels: null,\r\n          percent: null\r\n        }\r\n      },\r\n      left: {\r\n        min: {\r\n          pixels: null,\r\n          percent: null\r\n        },\r\n        newValue: {\r\n          pixels: null,\r\n          percent: null\r\n        },\r\n        max: {\r\n          pixels: null,\r\n          percent: null\r\n        }\r\n      }\r\n    };\r\n\r\n    switch (direction) {\r\n\r\n      case this.config.labels.UP:\r\n        this.runtime.selectedTile.newPosition.top.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels - this.metrics.tileHeight);\r\n        this.runtime.selectedTile.newPosition.top.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        this.runtime.selectedTile.newPosition.left.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        this.runtime.selectedTile.newPosition.left.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        break;\r\n\r\n      case this.config.labels.DOWN:\r\n        this.runtime.selectedTile.newPosition.top.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        this.runtime.selectedTile.newPosition.top.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels + this.metrics.tileHeight);\r\n        this.runtime.selectedTile.newPosition.left.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        this.runtime.selectedTile.newPosition.left.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        break;\r\n\r\n      case this.config.labels.LEFT:\r\n        this.runtime.selectedTile.newPosition.left.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels - this.metrics.tileWidth);\r\n        this.runtime.selectedTile.newPosition.left.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        this.runtime.selectedTile.newPosition.top.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        this.runtime.selectedTile.newPosition.top.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        break;\r\n\r\n      case this.config.labels.RIGHT:\r\n        this.runtime.selectedTile.newPosition.left.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels);\r\n        this.runtime.selectedTile.newPosition.left.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.left.pixels + this.metrics.tileWidth);\r\n        this.runtime.selectedTile.newPosition.top.min.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        this.runtime.selectedTile.newPosition.top.max.pixels = Math.round(this.runtime.selectedTile.oldPosition.top.pixels);\r\n        break;\r\n    }\r\n\r\n    if (!this.runtime.dragging) {\r\n      this.utils.addClass(tile.htmlElement, this.config.labels.PRESSED_LABEL +\r\n        \" \" +\r\n        this.config.labels.SELECTED_LABEL);\r\n    }\r\n\r\n    if (tile.canPush !== false && this.config.pushMultiple) {\r\n\r\n      tile.canPush.tiles = [];\r\n\r\n      for (var i = 1; i <= tile.canPush.n; i++) {\r\n\r\n        switch (tile.canPush.direction) {\r\n\r\n          case this.config.labels.UP:\r\n            tile.canPush.tiles.push(this.getTile({\r\n              col: tile.col,\r\n              row: tile.row - i\r\n            }));\r\n            break;\r\n\r\n          case this.config.labels.RIGHT:\r\n            tile.canPush.tiles.push(this.getTile({\r\n              col: tile.col + i,\r\n              row: tile.row\r\n            }));\r\n            break;\r\n\r\n          case this.config.labels.DOWN:\r\n            tile.canPush.tiles.push(this.getTile({\r\n              col: tile.col,\r\n              row: tile.row + i\r\n            }));\r\n            break;\r\n\r\n          case this.config.labels.LEFT:\r\n            tile.canPush.tiles.push(this.getTile({\r\n              col: tile.col - i,\r\n              row: tile.row\r\n            }));\r\n            break;\r\n\r\n        }\r\n\r\n        tile.canPush.tiles[i - 1].max = null;\r\n\r\n      }\r\n\r\n    }\r\n\r\n    this.vibrate(\"select\");\r\n\r\n    if (!!tile.canMove || !!tile.canPush) {\r\n      this.runtime.dragging = true;\r\n    }\r\n\r\n    //console.log(\"selected\",tile);\r\n\r\n  }\r\n};\r\n","game.getClosestColor = getClosestColor; /* Bower dependency included in the main .js */\r\n\r\ngame.setBgImage = function(params) {\r\n  \"use strict\";\r\n\r\n  if (!document.createElement ||\r\n    typeof params.imgUrl !== \"string\"\r\n  ) {\r\n    return false;\r\n  }\r\n\r\n  var img = document.getElementById(this.config.labels.BACKGROUND_IMAGE_ID) || document.createElement(\"img\");\r\n  var rgb = {};\r\n\r\n  console.log(\"loading image \" + params.imgUrl + \"...\");\r\n  img.crossOrigin = '';\r\n  img.src = params.imgUrl;\r\n  img.crossOrigin = \"\";\r\n  img.id = this.config.labels.BACKGROUND_IMAGE_ID;\r\n\r\n  this.utils.listenTo(img, \"load\", function(event, context) {\r\n      console.log(\"background image loading complete\", img)\r\n      context.applyBgImage(event.target);\r\n    },\r\n    this.runtime.eventListeners,\r\n    this\r\n  );\r\n\r\n  return true;\r\n\r\n};\r\n\r\n\r\ngame.applyBgImage = function(img) {\r\n\r\n  \"use strict\";\r\n\r\n  var i;\r\n  var tileName;\r\n  var tile;\r\n  var averageRGB;\r\n\r\n  this.runtime.backgroundImage = this.runtime.backgroundImage || {};\r\n  this.runtime.backgroundImage.src = img.src;\r\n\r\n\r\n  for (tileName in this.runtime.tiles) {\r\n    tile = this.getTile(tileName).htmlElement;\r\n    for (i = 0; i < tile.childNodes.length; i++) {\r\n      if (tile.childNodes[i].className === this.config.labels.TILE_INNER_CLASS) {\r\n        tile.childNodes[i].style.backgroundImage = \"url(\" + img.src + \")\";\r\n        break;\r\n      }\r\n    }\r\n  }\r\n\r\n  document.getElementById(this.config.labels.BACKGROUND_CONTAINER_ID).appendChild(img);\r\n\r\n  averageRGB = this.utils.getAverageRGB(img);\r\n\r\n  console.log(\"The average color for this image is \", averageRGB);\r\n\r\n  this.applyBgColor(averageRGB);\r\n\r\n  this.utils.stopListeningTo(\r\n    img,\r\n    \"load\",\r\n    this.runtime.eventListeners\r\n  );\r\n\r\n};\r\n\r\ngame.adjustColor = function(rgb, mode, amount) {\r\n  \"use strict\";\r\n\r\n  if (typeof rgb === \"undefined\") {\r\n    console.log(\"which color?\");\r\n    return false;\r\n  }\r\n  if (typeof amount !== \"number\") {\r\n    amount = 0.25;\r\n  }\r\n\r\n  function limit(n, min, max) {\r\n\r\n    n = Math.round(n);\r\n\r\n    if (n < min) {\r\n      return min;\r\n    }\r\n    if (n > max) {\r\n      return max;\r\n    }\r\n    return n;\r\n  }\r\n\r\n  switch (mode) {\r\n\r\n    case \"brighter\":\r\n      return {\r\n        r: limit(rgb.r * (1 + amount), 0, 255),\r\n        g: limit(rgb.g * (1 + amount), 0, 255),\r\n        b: limit(rgb.b * (1 + amount), 0, 255)\r\n      };\r\n\r\n    case \"darker\":\r\n      return {\r\n        r: limit(rgb.r * (1 - amount), 0, 255),\r\n        g: limit(rgb.g * (1 - amount), 0, 255),\r\n        b: limit(rgb.b * (1 - amount), 0, 255)\r\n      };\r\n\r\n    default:\r\n      console.log(\"color not changed\", rgb);\r\n      return rgb;\r\n\r\n  };\r\n\r\n};\r\n\r\ngame.applyBgColor = function(rgb) {\r\n\r\n  \"use strict\";\r\n\r\n  var rgbVal = \"rgb(\" + rgb.r + \",\" + rgb.g + \",\" + rgb.b + \")\";\r\n  var hexVal = \"#\" + rgb.r.toString(16) + rgb.g.toString(16) + rgb.b.toString(16);\r\n\r\n  var rgbDark = this.adjustColor(rgb, \"darker\", 0.65);\r\n  var rgbDarkVal = \"rgb(\" + rgbDark.r + \",\" + rgbDark.g + \",\" + rgbDark.b + \")\";\r\n  var hexDarkVal = \"#\" + rgbDark.r.toString(16) + rgbDark.g.toString(16) + rgbDark.b.toString(16);\r\n\r\n\r\n  var rgbBright = this.adjustColor(rgb, \"brighter\", 0.2);\r\n  var rgbBrightVal = \"rgb(\" + rgbBright.r + \",\" + rgbBright.g + \",\" + rgbBright.b + \")\";\r\n  var hexBrightVal = \"#\" + rgbBright.r.toString(16) + rgbBright.g.toString(16) + rgbBright.b.toString(16);\r\n\r\n\r\n  this.runtime.backgroundImage = this.runtime.backgroundImage || {};\r\n\r\n  this.runtime.backgroundImage.averageRGB = rgbVal;\r\n  this.runtime.backgroundImage.averageRGB_darker = rgbDarkVal;\r\n  this.runtime.backgroundImage.averageRGB_brighter = rgbBrightVal;\r\n\r\n  this.runtime.backgroundImage.averageHEX = hexVal;\r\n  this.runtime.backgroundImage.averageHEX_darker = hexDarkVal;\r\n  this.runtime.backgroundImage.averageHEX_brighter = hexBrightVal;\r\n\r\n  this.runtime.backgroundImage.blackish = (getClosestColor(hexVal, [\"#000\", \"#FFF\"]) == \"#000\");\r\n  this.runtime.backgroundImage.whiteish = !this.runtime.backgroundImage.blackish;\r\n\r\n  document.getElementById(this.config.labels.BACKGROUND_CONTAINER_ID).style.backgroundColor = rgbVal;\r\n  document.getElementById(this.config.labels.GAME_ID).style.backgroundColor = hexBrightVal;\r\n\r\n\r\n  var currentBoxShadow = this.utils.editCSSRule(\"#\" + this.config.labels.BOARD_ID + \" .\" + this.config.labels.TILE_INNER_CLASS, \"boxShadow\");\r\n\r\n  if (!!currentBoxShadow) {\r\n\r\n    var boxShadowProps = currentBoxShadow.replace(/,\\s+/g, \",\").split(\" \");\r\n\r\n    for (var i = 0; i < boxShadowProps.length; i++) {\r\n      if (boxShadowProps[i].indexOf(\"rgb\") > -1 || boxShadowProps[i].indexOf(\"#\") > -1) {\r\n        boxShadowProps[i] = rgbDarkVal;\r\n      };\r\n      break;\r\n    }\r\n\r\n    this.utils.editCSSRule(\"#\" + this.config.labels.BOARD_ID + \" .\" + this.config.labels.TILE_INNER_CLASS, \"boxShadow\", boxShadowProps.join(\" \"));\r\n\r\n    document.getElementById(this.config.labels.BOARD_ID).style.backgroundColor = hexDarkVal;\r\n\r\n  };\r\n\r\n};\r\n","game.shuffle = function(n, refresh) {\r\n  \"use strict\";\r\n\r\n  console.log(\"shuffle\");\r\n  this.vibrate(\"shuffle\");\r\n\r\n  if (typeof n === \"undefined\") {\r\n    n = 10 * this.config.size.n;\r\n  }\r\n  if (typeof refresh === \"undefined\") {\r\n    refresh = true;\r\n  }\r\n\r\n  var directions = [\r\n    this.config.labels.UP,\r\n    this.config.labels.RIGHT,\r\n    this.config.labels.DOWN,\r\n    this.config.labels.LEFT\r\n  ];\r\n\r\n  var movableTiles = [];\r\n\r\n  var d;\r\n\r\n  for (var i = 0; i < n; i++) {\r\n    d = directions[Math.round(Math.random() * (directions.length - 1))];\r\n\r\n    movableTiles = this.getMovableTiles({\r\n      direction: d,\r\n      pushing: false,\r\n      moving: true,\r\n      force: true\r\n    });\r\n\r\n    this.moveTile(\r\n      movableTiles[0], {\r\n        transitions: false,\r\n        force: true,\r\n        refresh: true\r\n      }\r\n    );\r\n  }\r\n\r\n  if (refresh) {\r\n    this.refresh({\r\n      transitions: true,\r\n      transitionDuration: 100\r\n    });\r\n  }\r\n\r\n};\r\n","game.start = function() {\r\n  \"use strict\";\r\n  this.runtime.started = new Date(); //   - - saves the time of game start\r\n  this.runtime.ended = false;\r\n  this.runtime.running = true; //   - - when true the game checks if the user has won at every move during refresh\r\n  this.runtime.movesCount = 0;\r\n  console.log(\"game started\");\r\n};\r\n","game.stop = function() {\r\n  \"use strict\";\r\n  //    - reverse start()\r\n  this.runtime.ended = new Date(); //   - - saves the time of game end\r\n  this.runtime.running = false; //    - - the game won't check if the user has won\r\n  console.log(\"game stopped\");\r\n};\r\n","game.vibrate = function(reasonToVibrate) {\r\n  \"use strict\";\r\n  return false;\r\n  var pattern = [20]\r\n\r\n  switch (reasonToVibrate) {\r\n\r\n    case \"select\":\r\n      pattern = [40];\r\n      break;\r\n\r\n    case \"bump\":\r\n      pattern = [60];\r\n      break;\r\n\r\n    case \"deselect\":\r\n      pattern = [30];\r\n      break;\r\n\r\n    case \"suffle\":\r\n      pattern = [Math.round(Math.random() * 300), Math.round(Math.random() * 300), Math.round(Math.random() * 300), Math.round(Math.random() * 300)];\r\n      break;\r\n\r\n    case \"move\":\r\n      pattern = [20];\r\n      break;\r\n\r\n    default:\r\n      break;\r\n  }\r\n\r\n  console.log(\"vibrate\", reasonToVibrate, pattern);\r\n\r\n  if (window.navigator && window.navigator.vibrate) {\r\n    window.navigator.vibrate(pattern);\r\n  };\r\n\r\n};\r\n"]}